\documentclass[a4paper,10pt,twoside,openany]{book}

\usepackage[lang=hebrew]{maths}
\usepackage{hebrewdoc}
\usepackage{stylish}
\usepackage{lipsum}

\title{סיכומי הרצאות במבוא לתורת המספרים \\ \large{חורף 2018, הטכניון}}
\author{הרצאותיו של פרופסור משה ברוך \\ \large סוכמו על ידי אלעד צורני}
\date{\today}

\begin{document}
\frontmatter
\frontpage{lehmer_sieve}{0.7\textwidth}{נפת להמר.}
\tableofcontents
\countlectures
\counttutorials
\newpage

\chapter*{הקדמה}

\section*{הבהרה}

סיכומי הרצאות אלו אינם רשמיים ולכן אין
\emph{כל הבטחה}
כי החומר המוקלד הינו בהתאמה כלשהי עם דרישות הקורס, או שהינו חסר טעויות.
\\
להיפך, ודאי ישנן טעויות בסיכום! אעריך אם הערות ותיקונים ישלחו אלי בכתובת דוא"ל
\textenglish{\href{mailto:tzorani.elad@gmail.com}{tzorani.elad@gmail.com}}.\\
אלעד צורני.

\section*{ספרות מומלצת.}

הספרות המומלצת עבור הקורס הינה כדלהלן.

\begin{english}
\begin{description}
\item[Ireland and Rosen:] A classical introduction to modern number theory
\end{description}
\end{english}

\section*{סילבוס}
חוגים אוקלידיים, משפט השארית הסיני ושלמים גאוסים. שרשים פרימיטיביים, הדדיות ריבועית, סכומי גאוס, סכומי יעקובי. הדדיות מסדר שלוש, הדדיות מסדר ארבע, מספרים אלגבריים ושדות ריבועיים.\\
הסילבוס יכלול את הפרקים הבאים מספר הקורס: 1,34,5,6,8,9.

\section*{דרישות קדם}
דרישת הקורס העיקרית הינה ידע של קורס מבוא בחבורות. נשתמש גם בידע מקורס בסיס בחוגים על חוגים אוקלידיים, ונניח את ההגדרות הבסיסיות. נחזור על נושא זה בתחילת הקורס.

\section*{ציון:}

\begin{enumerate}
\item בוחן אמצע: 20\% מגן.
\item שאלת תרגילי בית בבוחן
5\%
מגן.
\item שאלת תרגילי בית במבחן
5\%
מגן.
\item מבחן סופי.
\end{enumerate}

\mainmatter

\chapter{מבוא}
תורת המספרים נחלקת לשני תחומים עיקריים, תורת המספרים האלגברית ותורת המספרים האנליטית.
אנו עוסקים בהקדמה לתורת המספרים האלגברית, ונדבר בקורס בין השאר על שדות מספרים אלגבריים. את תוצאות הקורס אפשר להכליל בתחום של תורת שדות מחלקה.
\section{רקע היסטורי}

בין שנת 1640 לשנת 1654, מתמטיקאי בשם פרמה%
\footnote{Pierre de Fermat}
הסתכל על מספר שאלות בנוגע למספרים.%
\newlecture{24 באוקטובר}{2018}
\begin{question}
אילו ראשונים
$p$
הם מהצורה
\begin{enumerate}
\item $x^2 + y^2$
\item $x^2 + 2y^2$
\item $x^2 + 3y^2$
\end{enumerate}
כאשר
$x,y \in \ZZ$?
\end{question}
\begin{solution}
\begin{enumerate}
\item פרמה ניסח את המשפט הבא
\begin{theorem}
יהא
$p$
ראשוני אי־זוגי. קיימים שלמים
$x,y$
ש־%
$p= x^2 + y^2$
אם ורק אם
$p \equiv 1 \mod{4}$.
\end{theorem}
\item נסו למצוא חוקיות לבד.

\item
\begin{theorem}[פרמה]
 יהא
$p \neq 3$
ראשוני. קיימים
$x,y \in \ZZ$
כך ש־%
$x^2 + 3y^2 = p$
אם ורק אם
$p \equiv 1 \mod{3}$.
\end{theorem}
\end{enumerate}
\end{solution}
בין השנים 1729 ו־1772 אוילר%
\footnote{Leonhard Euler}
את שלושת המשפטים של פרמה.
אוילר הוכיח את המשפטים בשני שלבים, הורדה
\textenglish{descent}
והדדיות
\textenglish{Reciprocity}.
אנחנו נשתמש בחוגים אוקלידיים עבור השלב הראשון, על מנת לפשט את ההוכחה.

\section{חוגים וחוגים אוקלידיים}

\subsection{חוגים כלליים}

ניתן מספר דוגמאות לחוגים.

\begin{examples}
\begin{itemize}
\item $\ZZ$
\item $M_n\prs{R}$
חוג מטריצות
$n \times n$
מעל חוג
$R$.
\item חוג פולינומים
$R\brs{X}$
מעל חוג
$R$.
\end{itemize}
\end{examples}
בקורס זה נניח כי כל החוגים הינם קומוטטיבים עם יחידה וללא מחלקי אפס (כלומר אם $ab = 0$ אז $a=0$ או $b=0$).

\begin{definition}
חוג עם התכונות הנ"ל נקרא
\stress{תחום שלמות}.
\end{definition}
יהא
$R$
חוג ויהיו
$a,b \in R$.

\begin{definition}
נאמר כי
$a$
\stress{מחלק את}
$b$
אם קיים
$d \in R$
עבורו
$ad = b$.
אם כן, נסמן
$a \mid b$.
\end{definition}
\begin{definition}
$a$
הפיך אם
$a \mid 1$.
\end{definition}
\begin{definition}
$a\neq 0$
שאינו הפיך הוא
\stress{ראשוני}
ב־%
$R$
אם
$a \mid bc$
גורר
$a \mid b$
או
$a \mid c$.
\end{definition}
\begin{definition}
$a\neq 0$
שאינו הפיך נקרא
\stress{אי־פריק}
אם
$a=bc$
גורר כי
$b$
הפיך או
$c$
הפיך.
\end{definition}

\begin{definition}
$a \equiv b \mod{c}$
אם
$c \mid \prs{b-a}$.
\end{definition}
\begin{claim}
אם
$a$
ראושני, הוא אי פריק.
\end{claim}
\begin{proof}
יהי
$a$
ראשוני ונכתוב
$a=bc$.
אז
$a \mid bc$.
לכן
$a \mid b$
או
$a \mid c$.
אם
$a \mid b$
קיים
$d$
עבורו
$b = ad$.
אז
$a = adc$.
לכן
$a\prs{1-dc} = 0$
ולכן
$dc = 1$.
לכן $c$ הפיך.
אחרת,
$a \mid c$
ונקבל באותו אופן כי
$b$
הפיך.
\end{proof}

\subsection{חוגים אוקלידיים}

\begin{definition}
חוג
$R$
יקרא
\stress{חוג אוקלידי}
אם קיימת פונקצייה
$N \colon R \setminus\set{0} \to \NN_{0}$
כך שמתקיימות שתי התכונות הבאות.

\begin{enumerate}
\item
אם
$a,b \in R$
שונים מאפס, קיימים
$q,r \in R$
כך שמתקיים
$r = 0$
או
$N(r) < N(a)$
וגם
$b = qa + r$.
\item
אם
$a \neq 0$
וגם
$a=bc$
כאשר
$b,c$
אינם הפיכים, אז
$N(c),N(b)<N(a)$.
\end{enumerate}
\end{definition}

\begin{remark}
התכונה השנייה בהגדרה איננה הכרחית.
\end{remark}

\begin{examples}
\begin{enumerate}
\item $\ZZ$
עם
$N(x) = \abs{x}$.
\item $k\brs{X}$
פולינומים מעל שדה, עם
$N\prs{p(x)} = \deg\prs{p}$.
\end{enumerate}
\end{examples}
\begin{remark}
חלוקה בחוג אוקלידי איננה יחידה.
אם נדרוש גם
$N(0) \leq N(r) < N\prs{a}$
נקבל כי החלוקה תהיה יחידה.
\end{remark}

נניח בקורס כי
$\abs{r} \leq \frac{\abs{a}}{2}$.
אפשר לדרוש זאת במקרה
$r \geq 0$
כי אם
$b = qa + r$
נחליף את
$r$
ב־%
$r-a$.
נקבל
$b = \prs{q+1}a + \prs{r-a}$
ואז
\begin{align*}
\text{.} \abs{r-a} = \abs{a-r} = \abs{a} - \abs{r} \leq \abs{a} - \abs{\frac{a}{2}} = \abs{\frac{a}{2}}
\end{align*}
באופן דומה נוכיח עבור המקרה
$r < 0$.

\begin{proposition}
בחוג אוקלידי
$R$,
כל אידאל הינו ראשי. כלומר,
אם
$I \leq R$
אידאל, הוא מהצורה
$I = \prs{d} = dR = \set{dr}{r \in R}$
עבור
$d \in R$.
\end{proposition}
\begin{proof}
נמצא ב־%
$I$
איבר
$d$
עם נורמה מינימלית (כתרגיל) ואז נראה
$I = \prs{d}$.
ניקח איבר
$a \in I$,
נכתוב
$a = qd + r$.
אז
$r = 0$
כי לא ייתכן
$N(r) < N(d)$.
\end{proof}
\begin{definition}
יהא%
\newlecture{25 באוקטובר}{2018}
$R$
חוג ויהיו
$a,b\in \R \setminus \set{0}$.
$d$
נקרא
\stress{מחלק משותף גדול ביותר של $a$%
ו־%
$b$}
אם מתקיימות התכונות הבאות.
\begin{enumerate}
\item $d \mid a,b$
\item אם
$d' \in R$
מקיים
$d' \mid a,b$
אז
$d' \mid d$.
\end{enumerate}
\end{definition}

\begin{proposition}
יהא
$R$
חוג אוקלידי ויהיו
$a,b \in R$
שונים מאפס אז קיים מחלק משותף גדול ביותר ל־%
$a$
ו־%
$b$.
\end{proposition}
\begin{proof}
יהיו
$a,b \in R \setminus \set{0}$
ויהא
$I = \trs{a,b}$
האידאל הנוצר על ידי
$a$
ו-%
$b$.
לפי הטענה, יש ל־%
$I$
יוצר
$d$,
ונראה כי זהו ממג"ב (מחלק משותף גדול ביותר) של
$a,b$.
\begin{description}
\item[מחלק משותף:]
ניתן לכתוב
$a = 1\cdot a \in I$
לכן
$d \mid b$.
גם
$b = 1\cdot b \in I$
לכן
$d \mid b$.
\item[מקסימליות:]
אם
$d' \mid b$
וגם
$d' \mid b$.
קיימים
$x_1, y_1 \in R$
עבורם
$d = x_1a + y_1b$.
כעת
$d' \mid a,b$
ולכן
$d' \mid d$.
\end{description}
\end{proof}
\begin{definition}
איברים
$a,b \in R$
נקראים
\stress{חברים}
אם קיים איבר הפיך
$u \in R^{\times}$
עבורו
$a = bu$.
\end{definition}
\begin{note}
חברות זה יחס שקילות.
\end{note}
\begin{proposition}
יהיו
$a,b \in \R \setminus \set{0}$
עם
$d,d'$
ממג"ב. אז
$d,d'$
חברים.
\end{proposition}
\begin{proof}
מהגדרת ממג"ב מתקיים
$d' \mid d$
וגם
$d \mid d'$.
לכן יש
$x,y$
עבורם
$d = xd'$
וגם
$d' = yd$.
נציב את השיוויון השני בראשון ונקבל
$d = xyd$
לכן
$xy = 1$
ונקבל כי
$x,y$
הפיכים.
לכן
$d,d'$
חברים.
\end{proof}
\begin{corollary}
יהא
$d$
ממג"ב של
$a,b \in \R$.
קיימים
$x,y \in R$
כך שמתקיים
$d = xa + yb$.
\end{corollary}
\begin{corollary}
נמצא ממג"ב אחד
$d'$
עבורו
$\prs{d} = \trs{a,b}$.
$d,d'$
חברים ולכן יוצרים את אותו האידאל
$\prs{d'} = \prs{d}$.
לכן גם
$d'$
צירוף לינארי של
$a,b$
עם מקדמים ב־%
$R$.
\end{corollary}
\begin{example}[חוג השלמים הגאוסים]
נגדיר
$\ZZ\brs{i} = \set{a+bi}{a,b \in \ZZ} \subseteq \CC$.
\end{example}
\begin{proposition}
$\ZZ\brs{i}$
חוג אוקלידי.
\end{proposition}
\begin{proof}
נזכיר כי בשלמים יש חלוקה עם שארית
$b = qa + r$
עם התנאי
$\abs{r} \leq \frac{\abs{a}}{2}$.
נגדיר
$N\prs{a+bi} = a^2 + b^2 = \abs{a+bi}^2$.
יהיו
$a+bi, c+di \in R$.
נעשה חלוקה עם שארית ל־%
$a+bi, c+di$.
מתקיים קודם כל
\begin{equation}\label{gaussian}
\text{.} \frac{a+bi}{c+di} = \frac{ac + bd}{c^2 + d^2} + \frac{bc - ad}{c^2 + d^2}i
\end{equation}
נחפש מספר ב־%
$\ZZ[i]$
קרוב ביותר למנה זאת.
נעשה חלוקה עם שארית ב־%
$\ZZ$
במקום המקדמים במנה.
\begin{align*}
ac + bd &= x_1\prs{c^2 + d^2} + r_1 \\
bc - ad &= x_1\prs{c^2 + d^2}+r_2
\end{align*}
כאשר
$\abs{r_i} \leq \frac{c^2 + d^2}{2}$.
נציב בנוסחה
\ref{gaussian}
ונקבל
\begin{align*}
\frac{a+bi}{c+di} &= \frac{x_1\prs{c^2 + d^2} + r_1 + \prs{x_2\prs{c^2 + d^2} + r_2}i}{c^2 + d^2}\\
&= x_1 + x_2i + \frac{r_1 + r_2 i}{c^2 + d^2}
\end{align*}
או לאחר כפל שני האגפים
\begin{align*}
\text{.} a+bi = \prs{x_1 + x_2i}\prs{c+di}+\frac{r_1 + r_2i}{c^2 + d^2}\prs{c + di}
\end{align*}
נטען כי זאת חלוקה עם שארית. יש להראות כי הביטוי
$\frac{r_1 + r_2 i}{c^2+d^2}\prs{c+di}$
שלם גאוסי וכי הנורמה שלו קטנה מזאת של
$c+di$.
אכן זהו שלם גאוסי כיוון שניתן לכתוב
\[\text{.} \frac{r_1 + r_2i}{c^2 + d^2} \prs{c+di} = a+bi - \prs{x_1 + x_2i}\prs{c+di} \in \ZZ[i]\]
נשאיר את סיום ההוכחה כתרגיל.
\end{proof}
\begin{exercise}
הוכיחו את אי־השיוויון הבא כדי לסיים את ההוכחה.
\[\abs{\frac{\prs{r_1 + r_2}\prs{c+di}}{c^2 + d^2}}^2 < \abs{c+di}^2\]
\end{exercise}
\section{האלגוריתם של אוקלידס}
יהא%
\newtutorial{25 באוקטובר}{2018}
$R$
חוג אוקלידי ויהיו
$a,b \in \R \setminus \set{0}$.
האלגוריתם של אוקלידס מוצא ממג"ב של
$a$
ו־%
$b$.

\begin{algorithm}
\begin{enumerate}
\item נסמן
$b = r_0$.
\item נכתוב
$a = q_1 b + r_1$.
\item נחלק את
$r_{i-1}$
ב־%
$r_{i}$
עם
$i$
מקסימלי.
נכתוב
$r_{i-1} = q_{i+1}r_i + r_{i+1}$.
\\ נפסיק כשנקבל
$r_{n+1} = 0$
ואז
$r_n$
הוא ממג"ב של
$a,b$.
\end{enumerate}
\end{algorithm}
\begin{exercise}
מצאו ממג"ב של
$91$
ו־%
$35$.
\end{exercise}
\begin{solution}
\begin{align*}
91 &= 2\cdot 35 + 21 \\
35 &= 1 \cdot 21 + 14 \\
21 &= 1\cdot 14 + 7 \\
14 &= 2\cdot 7 + 0
\end{align*}
לכן
$\gcd\prs{91,35} = 7$.
\end{solution}
\begin{exercise}
מצאו את
$\gcd\prs{13 + 13i, -1+18i}$.
\end{exercise}
\begin{solution}
נציג שני פתרונות.
\begin{enumerate}
\item נבצע חלוקה עם שארית.
מתקיים
\begin{align} \label{gaussian_exercise}
\text{.}\frac{13 + 13i}{-1+18i} = \frac{17}{25}-\frac{19}{25}i
\end{align}
נבצע חלוקה עם שארית בשלמים.
\begin{align*}
17 &= 1\cdot 25 + \prs{-8} \\
-19 &= -1\cdot 25 + 6
\end{align*}
נציב ב־%
\ref{gaussian_exercise}
ונקבל
\begin{align*}
\text{.} \frac{13 + 13i}{-1+18i} &= \frac{25 - 8 - 25i + 6i}{25} = 1-i + \frac{-8 + 6i}{25}
\end{align*}
נכפול ונקבל
\begin{align*}
13+13i &= \prs{1-i}\prs{-1+18i} + \frac{-8 + 6i}{25}\prs{-1+18i} \\
\text{.} \phantom{13+13i} &= \prs{1-i}\prs{-1+18i} + \prs{-4 -6i}
\end{align*}
כעת נחלק את
$\prs{-1 + 18i}$
בשארית
$-4-6i$.
יוצא
\[\text{.} -1 + 18i = \prs{-2-2i}\prs{-4-6i} + 3 - 2i\]
מחלקים שוב
$-4+6i = \prs{-2i}\prs{3-2i} + 0$
ולכן
$\gcd\prs{13+13i, -1+18i} = 3-2i$.
\item
נזכיר טענה.
\begin{proposition}
יהא
$a+bi \in \ZZ[i]$.
אם
$N\prs{a+bi} = a^2 + b^2$
ראשוני ב־%
$\NN$
אז
$a+bi$
ראשוני ב־%
$\ZZ[i]$.
\end{proposition}
נפרק את
$13 + 13i$
ואת
$-1+18i$
למכפלות ראשוניים.
מתקיים
$13 + 13i = 13\prs{1+i}$
כאשר
$N\prs{1+i} = 1^2 + 1^2 = 2$
ראשוני, לכן
$1+i$
ראשוני.
ניתן לכתוב
$13 = \prs{2+3i}\prs{2-3i}$
כאשר מהטענה זה פירוק לראשוניים.
לכן
\[13+13i = \prs{2+3i}\prs{2-3i}\prs{1+i}\]
פירוק לראשוניים.
\\
נפרק את
$-1 + 18i$.
מתקיים
\[\text{.} N\prs{-1+18i} = 1^2 + 18^2 = 325 = 5^2 \cdot 13\]
הנורמה אצלנו כפלית ולכן למחלקים נורמות בקבוצה
$\set{5, 5^2, 13}$
(נפרט יותר בהרצאה).
נחלק את
$-1 + 18i$
ב־%
$2+3i$.
יוצא
\[\prs{-1+18i} = \prs{2+3i}\prs{1+2i}\prs{2-i}\]
נקבל כי $2+3i$
הוא הגורם המשותף היחיד בפירוק לראשוניים עד־כדי חברות (לחברים יש אותה הנורמה) ולכן
$\gcd\prs{13+13i, -1+18i} = 2+3i$.
\end{enumerate}
\end{solution}
\begin{theorem}[אוקלידס]
יש אינסוף ראשוניים ב־%
$\NN$.
\end{theorem}
\begin{proof}
נניח בשלילה שיש מספר סופי של ראשוניים
$p_1, \ldots, p_k$
ונסמן
$N = \prs{\prod_{i=1}^k p_i} + 1$.
אם
$p_i \in N$
אז
$p_i \mid 1$
וזו סתירה לכך שיש ראשוני שמחלק את
$N$.
\end{proof}
\begin{exercise}
יש
ב־%
$\NN$
אינסוף ראשוניים
$p$
שמקיימים
$p \equiv 3 \mod{4}$.
\end{exercise}
\begin{solution}
נניח שיש מספר סופי של ראשוניים
$p_1, \ldots, p_k \equiv 3 \mod{4}$.
ניקח
$N = 4 \prs{\prod_{i=1}^k p_i} - 1$
ואז
$p_i \nmid N$
לכל
$i$.
נפרק את
$N$
לראשוניים
$N = \prod_{i=1}^m q_i$.
אז קיים
$q_i \equiv 3 \mod{4}$
כי אחרת
\[ N \equiv \prod_{i=1}^m q_i \equiv \prod_{i=1}^m 1 \equiv 1 \mod{4}\]
בסתירה.
אבל
$q_i \neq p_j$
לכל
$j \in [k]$,
בסתירה.
\end{solution}
\begin{definition}
$a,b$
\stress{זרים}
אם
$\gcd\prs{a,b} = 1$. \newlecture{31 באוקטובר}%
{2018}
\end{definition}
\begin{theorem}
נניח
$\gcd\prs{a,b} = 1$
ויהא
$c$
מחלק משותף של
$a$
ו־%
$b$.
אז
$c\mid a,b$
ולכן
$c \mid 1$,
כלומר יש
$e$
עבורו
$ce = 1$
ולכן
$c$
הפיך.
\end{theorem}
\begin{proposition}
$\gcd\prs{a,b} = 1$
אם ורק אם קיימים
$x,y \in R$
עבורם
$xa + yb = 1$.
\end{proposition}
\begin{proposition}
אם
$\gcd\prs{a,b} = 1$,
ראינו בהרצאה כי יש
$x,y$
כנדרש.
להיפך, נניח שקיימים
$x,y \in R$
כך שמתקיים
$xa + yb = 1$.
אם
$d \mid a,b$
אז
$d \mid xa + yb = 1$
לכן
$d \mid 1$
ולכן
$1$
ממג"ב.
\end{proposition}
\begin{theorem}
יהא
$R$
חוג אוקלידי. אם
$p \in R$
הוא אי־פריק, אז
$p$
ראשוני.
\end{theorem}
\begin{proof}
נניח ש־%
$p$
ראשוני אי־פריק ונוכיח כי הוא ראשוני. נניח ש־%
$p\mid ab$
וגם
$p \nmid a$,
ונראה
$p \mid b$.
נניח בשלילה ש־%
$a,p$
אינם זרים
ויהא
$d \mid p,a$.
קיים
$c \in R$
עבורו
$p = cd$.
$p$
אי־פריק, לכן $c$ או
$d$
הפיכים.
אם
$c$
הפיך, $d$ חבר של
$p$.
אז
$p \mid a$
בסתירה.
אחרת,
$d$
הפיך ואז בבירור
$a,p$
זרים.
כעת, יש
$x,y \in R$
עבורם
$xa + yp = 1$.
נכפול ונקבל
$xab + ypb = b$
ומתקיים
$p \mid ypb, xab$
כי
$p \mid ab$.
לכן
$p \mid b$.
\end{proof}
\section{פירוק לראשוניים בחוג אוקלידי}
\begin{proposition}
יהא
$R$
חוג אוקלידי ויהא
$u \in R \setminus \set{0}$
כך ש־%
$N\prs{u} = 0$.
אז
$u \in R^{\times}$.
\end{proposition}
\begin{proof}
נחלק את
$1$
ב־%
$u$.
מתקיים
$1 = qu + r$
כאשר
$N(r) < 0$
או
$r = 0$.
אבל, לא ייתכן
$N(r) < 0$
לכן
$r=0$
לכן
$qr = 1$
ולכן
$u \in R^{\times}$.
\end{proof}
\begin{proposition}
יהי
$R$
חוג אוקלידי.
נניח ש־%
$N\prs{a} = 1$
ו־%
$a \notin R^{\times}$
אינו הפיך.
אז
$a$
ראשוני.
\end{proposition}
\begin{proof}
נניח כי
$a=bc$.
נניח בשלילה ש־%
$b,c$
שניהם אינם הפיכים. אז
$N(b),N(c) < N(a) = 1$.
לכן
$N(b) = N(c) = 0$
ולכן
$b,c$
הפיכים, בסתירה.
\end{proof}
\begin{theorem}
יהא
$R$
אוקלידי ויהא
$a \in R \setminus \set{0}$
שאינו הפיך.
אז קיימים ראשוניים (אי־פריקים)
$p_1, \ldots, p_k \in R$
עבורם
$a = p_1 \cdot \ldots \cdot p_k$.
כמו כן, אם קיימים ראשוניים
$q_1, \ldots, q_m$
עבורם
$a = q_1\cdot\ldots\cdot q_m$
אז
$m=k$
ועד כדי שינוי סדר
$p_i$
חבר של
$q_i$
לכל
$i$.
\end{theorem}
\begin{example}
$15 = 3\cdot 5 = \prs{-5}\prs{-3}$
אבל
$-5,5$
חברים וגם
$-3,3$
חברים.
\end{example}
\begin{proof}[עבור הקיום]
נוכיח באינדוקציה על
$N\prs{a}$.
\begin{description}
\item[בסיס:]
אם
$N(a) = 0$,
$a$
הפיך ולכן הטענה נכונה באופן ריק.
אם
$N(a) = 1$
ו־%
$a$
אינו הפיך, הוא ראשוני.
\item[צעד:]
אם
$a$
ראשוני (אי־פריק), סיימנו. אחרת קיימים
$b,c \in R$
שאינם הפיכים המקיימים
$a=bc$.
אז
$N(b),N(c) < N(a)$
ולכן מהנחת האינדוקציה קיימים פירוקים של
$b$
ושל
$c$,
שמכפלתם היא פירוק של
$a$.
\end{description}
\end{proof}
\begin{proposition}
יהיו
$p_1,p_2 \in R$
ראשוניים ונניח
$p_1 \mid p_2$.
אז
$p_1,p_2$
חברים.
\end{proposition}
\begin{proof}
$p_2 = p_1 \cdot b$
עבור
$b$
כלשהו. כעת
$p_2 = p_1 \cdot b$
ו־%
$p_2$
אי־פריק, לכן
$b$
הפיך.
\end{proof}
\section{חוג השלמים הגאוסים
$\ZZ\brs{i}$}
\begin{remark}
בחוג
$\ZZ\brs{i}$
הנורמה היא כפלית.
\[N\prs{z_1 z_2} = N\prs{z_1} N\prs{z_2}\]
כמו כן, אם
$z = a+bi$
אז
$N\prs{z} = \prs{a+bi}\prs{a-bi}=z\cdot\bar{z} = \abs{z}^2$.
אם
$z \in \ZZ\brs{i}$
גם
$\bar{z} \in \ZZ\brs{i}$.
\end{remark}
\begin{proposition}
$z \in \ZZ\brs{i}$
הפיך אם ורק אם
$N\prs{z} = 1$.
\end{proposition}
\begin{proof}
אם
$z$
הפיך, יש
$w \in \ZZ[i]$
עבורו
$zw = 1$.
לכן
$N(zw) = N(z)N(w) = 1$
ולכן
$N(z) = N(w) = 1$
כי הנורמה מקבלת ערכים שלמים חיוביים.\\
לכיוון השני,
$z \in \ZZ[i]$
מקיים
$N(z) = 1$
אם ורק אם
$a^2 + b^2 = 1$
עבור
$z = a+bi$.
לכן
$z \in \set{\pm 1, \pm i}$
וכל אלו הפיכים כי
$\prs{-1}^2 = i \cdot \prs{-i} = 1$.
\end{proof}
\begin{proposition}
יהא
$p \in \NN$
ראשוני ונניח שקיימים
$x,y \in \ZZ$
עבורם
$x^2 + y^2 = p$.
אז
$p$
אינו ראשוני ב־%
$\ZZ[i]$.
\end{proposition}
\begin{proof}
$p = \prs{x+iy}\prs{x-iy}$
פרוק ב־%
$\ZZ[i]$
שאינו טריוויאלי כי
\[\text{.} N\prs{x+iy} = N\prs{x-iy} = x^2 + y^2 = p \neq 1\]
\end{proof}
\begin{proposition}
יהא
$p \in \NN$
ראשוני.%
\newlecture{1 בנובמבר}%
{2018}
אם
$p \in \ZZ[i]$
אינו ראשוני, אז קיימים שלמים
$x,y \in \ZZ$
עבורם
$x^2 + y^2 = p$.
\end{proposition}
\begin{proof}
$p$
אינו ראשוני ב־%
$\ZZ[i]$
לכן קיימים
$z_1,z_2 \in \ZZ[i[$
שאינם הפיכים עבורם
$p = z_1 z_2$.
לכן
\[p^2 = N(p) = N\prs{z_1 z_2} = N\prs{z_1} N\prs{z_2}\]
ולכן
$N\prs{z_i} \in \set{1,p,p^2}$
כי
$p$
ראשוני ב־%
$\ZZ$.
אבל
$z_i$
אינם הפיכים לכן
$N\prs{z_i} = p$.
נכתוב
$z_1 = x+iy$
ואז
$N\prs{z_1} = x^2 + y^2 = p$.
\end{proof}
\begin{theorem}[אוילר 1729, הורדה]
יהי
$p \in \NN$
ראשוני.
אם קיימים
$x,y,c \in \ZZ$
כך שמתקיים
$\gcd\prs{c,p}=1$
וגם
$x^2 + y^2 = cp$
אז קיימים
$x_1,y_1 \in \ZZ$
עבורם
$x_1^2 + y_1^2 = p$.
\end{theorem}
\begin{proof}
נניח ש־%
$x^2 + y^2 = cp$
עם
$\gcd\prs{c,p} = 1$.
אז
$\prs{x+iy}\prs{x-iy} = cp$.
כלומר, מהטענה, צריך להוכיח ש־%
$p$
אינו ראשוני ב־%
$\ZZ[i]$.
נניח בשלילה שהוא כן ראשוני.
ב־%
$\ZZ[i]$
מתקיים
$p \mid \prs{x+iy}\prs{x-iy}$.
לכן
$p \mid \prs{x+iy}$
או
$p \mid \prs{x-iy}$.
בה"כ נניח
$p \mid \prs{x+iy}$.
אז קיימים
$n,m \in \ZZ$
עבורם
$x+iy = p\prs{n+mi} = pn + pmi$.
אז
$p \mid x,y$
ב־%
$\ZZ$.
אז
$p^2 \mid x^2 + y^2 = cp$
בסתירה לכך ש־%
$\gcd\prs{c,p} = 1$.
\end{proof}
\begin{corollary}
יהי
$p \in \NN$
ראשוני. אז קיימים
$x_1,y_1 \in \ZZ$
עבורם
$x_1^2 + y_1^2 = p$
אם ורק אם קיימים
$x,y \in \ZZ$
עבורם
$x^2 + y^2 \equiv 0 \mod{p}$
וגם
$x,y \not\equiv 0 \mod{p}$.
\end{corollary}
\begin{proof}
אם
$p = x_1^2 + y_1^2$,
נניח בה"כ
$x_1, y_1 \geq 0$.
אבל,
$p$
ראשוני ולכן
$x_1, y_1 > 0$.
כעת
$0 < x_1,y_1 < p$
ולכן
$x_1^2 + y_1^2 \equiv 0 \mod{p}$
כאשר
$x_1,y_1 \not\equiv 0 \mod{p}$.\\
לכיוון השני, אם יש
$x,y \in \ZZ$
עבורם
$x^2 + y^2 \equiv 0 \mod{p}$
וגם
$x,y \not\equiv 0 \mod{p}$,
יש
$c$
עבורו
$x^2 + y^2 = cp$.
נניח בה"כ כי
$0<x,y<p$
ובעצם
$-\frac{p}{2} < x,y < \frac{p}{2}$
כי ניתן להזיז ב־%
$p$.
בפרט
$x^2 + y^2 < 2 \cdot \frac{p^2}{4} = \frac{p^2}{2}$.
כעת
\[x^2 + y^2 = cp\]
ולכן
$1 \leq c < \frac{p}{2}$
ולכן
$\gcd\prs{c,p} = 1$.
לכן מהשקילות יש
$x_1,y_1 \in \ZZ$
עבורם
$x_1^2 + x_2^2 = p$
כנדרש.
\end{proof}
\begin{theorem}[אוילר]
יהי%
\newlecture{7 בנובמבר}%
{2018}
$p \in \NN$
ראשוני.
אם קיימים
$x,y,c \in \ZZ$
כך שמתקיים
$\gcd\prs{c,p}=1$
וגם
$x^2 + 2y^2 = cp$
אז קיימים
$x_1,y_1 \in \ZZ$
עבורם
$x_1^2 + 2y_1^2 = p$.
\end{theorem}
\begin{proof}
אותה הוכחה עבור משפט ההורדה של אוילר, כאשר נעבוד ב־%
$\ZZ\brs{\sqrt{2}i}$.
\end{proof}
\begin{theorem}[אוילר]
יהי
$p \in \NN$
ראשוני.
אם קיימים
$x,y,c \in \ZZ$
כך שמתקיים
$\gcd\prs{c,p}=1$
וגם
$x^2 + 3y^2 = cp$
אז קיימים
$x_1,y_1 \in \ZZ$
עבורם
$x_1^2 + 3y_1^2 = p$.
\end{theorem}
\begin{corollary}
עבור
$k \in \set{1,2,3}$
יש פתרון למשוואה
$x^2 + ky^2 \equiv 0 \mod{p}$
עם
$x,y \not\equiv 0 \mod{p}$
אם ורק אם יש פתרון למשוואה
$x^2 + ky^2 = p$.
\end{corollary}

עשינו רדוקציה למציאת ראשוניים מהצורות
\begin{align*}
x^2 + y^2 \\
x^2 + 2y^2 \\
x^2 + 3y^2
\end{align*}
למציאת פתרונות
$\prs{a,b} \neq \prs{0,0}$
למשוואות
\begin{align*}
x^2 + y^2 \equiv 0 \mod{p} \\
x^2 + 2y^2 \equiv 0 \mod{p} \\
\text{.} x^2 + 3y^2 \equiv 0 \mod{p}
\end{align*}
עבור
$k \in \set{1,2,3}$
מתקיים
$x^2 + ky^2 \equiv 0 \mod{p}$
אם ורק אם
$x^2 = -ky^2$
אם ורק אם
$\prs{\frac{x}{y}}^2 = -k$.
לכן הבעיה שקולה לבדיקת קיום שורש של
$-k$
בשדה
$\FF_p$.
\begin{question}
עבור אילו
$p$
ראשוני ו־%
$a \in \FF_p$,
קיים
$z \in \FF_p$
עבורו
$z^2 = a$?
\end{question}

בחוג
$\ZZ\brs{i}$
לקחנו את
$\ZZ$
והוספנו שורש יחידה מסדר
$4$.
נסתכל על שורשי יחידה מסדר
$3$.
יהא
$\omega = e^{\frac{2\pi i}{3}} = \frac{-1 + \sqrt{3}i}{2}$
ואז
$\omega^2 = \bar{\omega} = \frac{-1 - \sqrt{3}i}{2}$.
$\omega$
שורש של הפולינום הציקלוטומי
$\Phi_3\prs{x} \ceq x^2 + x^2 + 1$.
מכך נובע כי
$\bar{\omega} = \omega^2 = -1 - \omega$.
מתקיים
$\ZZ\brs{\omega} = \prs{a + b\omega}{a,b\in \ZZ}$
כי הוספנו שורש של פולינום אי־פריק ממעלה
$2$
(לחלופין, הדבר נובע מכך ש־%
$\omega^2 = 1-\omega$).

מתקיים
\begin{align} \label{omega}
a+b\omega = a+b\prs{\frac{-1 + \sqrt{3}i}{2}} = a -\frac{b}{2} + \frac{b\sqrt{3}i}{2}
\end{align}

\begin{proposition}
יהיו
$a,b,c,d\in \ZZ$.
אם
$a+b\omega = c + d\omega$
אז
$a=c, b=d$.
\end{proposition}
\begin{proof}
נובעת מ־%
\ref{omega}.
\end{proof}
\begin{theorem}
$\ZZ\brs{\omega}$
חוג אוקלידי.
\end{theorem}
\begin{proof}
נגדיר
$N\prs{z} \ceq \abs{z}^2$
ואז מתקיים
\begin{align*}
N(z) &= \abs{z}^2 \\
&= \abs{a+b\omega}^2 \\
&= \prs{a+b\omega} \prs{a +b\bar{\omega}} \\
&= \prs{a+b\omega}\prs{a+b\omega^2} \\
&= a^2 + ab\omega + ab\omega^2 + b^2 \\
&= a^2 + ab\omega + ab\prs{-1-\omega} + b^2 \\
\text{.} \phantom{N(z)} &= a^2 -ab + b^2
\end{align*}
קיבלנו
$N\prs{a+b\omega} = a^2 -ab + b^2$.
נראה קיום של חלוקה עם שארית.
יהיו
$z_1, z_2 \in \ZZ\brs{\omega}$
ונרצה לחלק עם שארית
$z_1 = qz_2 + r$.
נסמן
$\tilde{q} = \frac{z_1}{z_2} \in \CC$
וניקח
$q$
את הנקודה הקרובה ביותר ב־%
$\ZZ\brs{\omega}$.
אם
$r = 0$
סיימנו. אחרת:
אם מרחק המרכז של משולש עם צלעות באורך 1 מהקודקוד הוא
$x$
אז
$\prs{\frac{1}{2}}^2 + \prs{1-x}^2 = x^2$
ולכן
$x = \frac{5}{8}$.
אז
\[N\prs{q-\tilde{q}} \leq \frac{25}{64}\]
ואז
\[N\prs{r} = N\prs{z_1 - qz_2} = N\prs{\tilde{q}z_2 - qz_2} = N\prs{\tilde{q} - q} N\prs{z_2} \leq \frac{25}{64}N\prs{z_2} < N\prs{z_2}\]
כנדרש.
\end{proof}
\begin{proposition}
$z \in \ZZ\brs{\omega}$
הפיך אם ורק אם
$N\prs{z} = 1$.
\end{proposition}
\begin{proof}
נניח כי
$z$
הפיך. אז יש
$w$
עבורו
$zw = 1$.
אז
$N\prs{zw} = N\prs{1} = 1$
ולכן
$N\prs{z} N\prs{w} = 1$.
מתקיים
$N(z),N(w) \in \NN$
ולכן
$N(z) = N(w) = 1$.\\
להיפך, נניח כי
$N\prs{z} = 1$.
נכתוב
$z = a + b\omega$.
אז
\[\text{.} N\prs{z} = N\prs{a+b\omega} = \prs{a+b\omega}\prs{a+b\prs{-1-\omega}} = \prs{a+b\omega}\prs{a-b-b\omega} = 1\]
\end{proof}

נרצה כעת למצוא את כל ההפיכים בחוג
$\ZZ\brs{\omega}$,
כלומר כל האיברים מנורמה 1.
נניח
$z = a+b\omega \in \ZZ\brs{\omega}$
מנורמה 1. אז
$N\prs{z} = a^2 - ab + b^2 = 1$
ואז
\begin{align*}
\prs{a-\frac{b}{2}}^2 + \frac{3}{4}b^2 &= 1 \\
4\prs{a-\frac{b}{2}}^2 + 3b^2 &= 4 \\
\prs{2a-b}^2 + 3b^2 &= 4
\end{align*}
ונקבל ע"י מעבר על כל האפשרויות את הפתרונות הבאים.
\begin{align*}
\prs{a,b} \in \set{\prs{0,1},\prs{0,-1}, \prs{1,0}, \prs{1,1}, \prs{-1,0}, \prs{-1,-1}}
\end{align*}
מתקיים
$-1-\omega = \omega^2$
לכן ההפיכים הם
$\set{\pm 1, \pm \omega, \pm \omega^2}$.

\begin{corollary}[האקסיומה השנייה של הנורמה בחוג אוקלידי]
אם
$z_1, z_2, z_3 \in \ZZ\brs{\omega}$
שונים מאפס וגם%
\newlecture{8 בנובמבר}%
{2018}
$z_3 = z_1 z_2$
כאשר
$z_1, z_2$
אינם הפיכים, אז
$N\prs{z_1} < N\prs{z_3}$
ו־%
$N\prs{z_2} < N\prs{z_3}$.
\end{corollary}
\begin{proposition}
יהי
$p \in \NN$
ראשוני. קיימים
$a,b \in \ZZ$
כך ש־%
$a^2 - ab + b^2 = p$
אם ורק אם
$p = p+0\omega$
אינו ראשוני ב־%
$\ZZ\brs{\omega}$.
\end{proposition}
\begin{remark}
הטענה מקבילה לטענה המתאימה ב־%
$\ZZ\brs{i}$.
ניתן לכתוב
$p = a^2 + b^2$
אם ורק אם
$p$
אינו ראשוני ב־%
$\ZZ\brs{i}$.\\
ב־%
$\ZZ\brs{2\sqrt{i}}$
הטענה המקבילה תתקיים עבור
$p = a^2 + 2b^2$
עם הוכחה אנלוגית.
\end{remark}
\begin{proof}
\begin{description}
\item[כיוון ראשון:]
נניח שקיימים
$a,b \in \ZZ$
עבורם
$a^2 - ab + b^2 = p$.
אז
$p=\prs{a+b\omega}\prs{a-b-b\omega}$
פירוק של
$p$
ב־%
$\ZZ\brs{\omega}$
כי
$a+b\omega$
ו־%
$a-b-b\omega$
אינם הפיכים%
\footnote{כי לכל
$a,b$
כך שאחד מהאיברים הנ"ל שווה לאחד ההפיכים בחוג, נקבל כי
$a^2 - ab + b^2$
אינו ראשוני ב־%
$\ZZ$},
לכן
$p$
איננו ראשוני ב־%
$\ZZ\brs{\omega}$.
\item[כיוון שני:]
נניח כי
$p = p+0\omega$
אינו ראשוני ב־%
$\ZZ\brs{\omega}$.
אז קיימים
$z_1, z_2 \in \ZZ\brs{\omega}$
שאינם הפיכים, כך שמתקיים
$p = z_1 z_2$.
אז
$p^2 = N\prs{p} = N\prs{z_1} N\prs{n_2}$
לכן
$N\prs{z_1} = N\prs{z_2} = p$.
אז אם
$z_1 = a+b\omega$
נקבל
$N\prs{z_1} = a^2 - ab + b^2 = p$.
\end{description}
\end{proof}
\begin{theorem}[\textenglish{descent}]
יהי
$p \in \NN$
ראשוני. אם קיימים שלמים
$a,b,c \neq 0$
עבורם
$a^2 - ab + b^2 = cp$
כאשר
$\prs{c,p} = 1$
אז קיימים שלמים
$x,y\in \ZZ$
עבורם
$x^2 - xy + y^2 = p$.
\end{theorem}
\begin{proof}
נניח שקיימים
$a,b,c \in \ZZ$
כך שמתקיים
$a^2 - ab + b^2$
כאשר
$\prs{c,p} = 1$.
אז
$\prs{a+b\omega}\prs{a-b-b\omega} = cp$.
נניח בשלילה כי
$p + 0\omega$
ראשוני ב־%
$\ZZ\brs{\omega}$.
אז
$p \mid a+b\omega$
או
$p \mid a-b-b\omega$.
נניח כי
$p \mid a-b-b\omega$
ואז קיימים
$c,d\in\ZZ$
עבורם
\begin{align*}
p\prs{c+d\omega} &= a-b-b\omega \\
\text{.} pc + pd\omega &= a-b-b\omega
\end{align*}
מטענה קודמת, יש שיוויון בין החלקים החופשיים ובין המקדמים של
$\omega$.
לכן
\begin{align*}
pc &= a-b \\
pd &= -b
\end{align*}
ולכן
$p\mid a-b, b$
כלומר
$p \mid a$.
לכן
$p^2 \mid a^2 - ab + b^2 = cp$
כאשר זאת סתירה כי
$\prs{c,p} = 1$.
\end{proof}

\begin{corollary}
יהי
$o \in \NN$
ראשוני. קיימים
$x,y\in \ZZ$
עבורם
$x^2 - xy + y^2$,
אם ורק אם יש פתרון למשוואה
$a^2 - ab + b^2 \equiv 0 \mod{p}$
עם
$a,b \not\equiv 0 \mod{p}$.
\end{corollary}
\begin{remark}
יש מסקנה דומה (עם הוכחה שקולה) עבור
$p = x^2 + 3y^2$
אם ורק אם יש פתרון
$x^2 + 3y^2 \equiv 0 \mod{p}$
עבור
$x,y \not\equiv 0 \mod{p}$.
\end{remark}
\section{קונגרואנציות ב־%
$\ZZ$}
אם רוצים לפתור את אחת המשוואות הבאות%
\newlecture{14 בנובמבר}%
{2018}
\begin{align*}
x^2 + y^2 &\equiv 0 \mod{p} \\
x^2 + 2y^2 &\equiv 0 \mod{p} \\
x^2 + 3y^12 &\equiv 0 \mod{p} \\
x^2 -xy + y^2 &\equiv 0 \mod{p}
\end{align*}
רוצים להסתכל על המשוואות בקונגרואנציה.

\begin{definition}
יהיו
$a,b,m\in \ZZ$
עם
$m \neq 0$.
נאמר כי
$a \equiv b \mod{m}$
אם
$m \mid b-a$.

\end{definition}

\begin{proposition}
$\equiv$
הוא יחס שקילות.
\end{proposition}
\begin{notation}
אם
$a \in \ZZ$
אז
$\bar{a}$
מחלקת השקילות של
$a$.
מתקיים
$\bar{a} = a+\ZZ m$.
\end{notation}
\begin{proposition}
יש בדיוק
$m$
מחלקות שקילות, והן
$\bar{0},\bar{1}, \ldots, \overline{m-1}$.
\end{proposition}
\begin{notation}
אוסף מחלקות השקילות יסומן
$\quot{\ZZ}{m\ZZ}$.
\end{notation}
\begin{remark}
$\quot{\ZZ}{m\ZZ}$
הוא חוג שנקרא חוג השאריות מוד
$m$
ביחס לפעולות חיבור וכפל המוגדרות על ידי
\begin{align*}
\bar{a} + \bar{b} &\ceq \overline{a+b} \\
\text{.} \bar{a} \cdot \bar{b} &\ceq \overline{a\cdot b}
\end{align*}
\end{remark}
\begin{proposition}
$\quot{\ZZ}{m\ZZ}$
שדה ם ורק אם
$m$
ראשוני.
\end{proposition}
\begin{remark}
אם
$x \in \ZZ$
ופותר את המשוואה
$ax \equiv b \mod{m}$
אז כל איבר ב־%
$\bar{x}$
הוא פתרון.
ההוכחה ישירה על ידי הצבה. כלומר, אנחנו מחפשים מחלקות שקילות שפותרות את המשוואה.
באופן דומה, אם נחליף את
$a$
באיבר
$a_1 \in \bar{a}$
נקבל את אותם הפתרונות למשוואה. כנ"ל עבור
$b$.
כלומר, אנו מחפשים פתרונות ב־%
$\quot{\ZZ}{m\ZZ}$
למשוואה
$\bar{a}x = \bar{b}$.
זה נכון לכל משוואה בקונגרואנציה.
\end{remark}

\subsection{המשוואה
$ax \equiv b \mod{m}$}
\begin{example}
נסתכל על המשוואה
$6x \equiv 9 \mod{15}$.\newlecture{15 בנובמבר}%
{2018}
נניח ש־%
$m > 0$
ונניח ש־%
$a,b \in \ZZ$
ו־%
$a \neq 0$.
נסמן ב־%
$0 < d = \prs{a,m}$
ויהא
$a' = \frac{a}{d}$
ו־%
$0 < m' = \frac{m}{d}$.
\end{example}
\begin{proposition}
למשוואה
$ax \equiv b \mod{m}$
יש פתרונות אם ורק אם
$d \mid b$. \\
אם
$d \mid b$
יש בדיוק
$d$
פתרונות.\\
אם
$x_0$
הוא פתרון, אז הפתרונות האחרים הם
$x_0 + m', x_0 + 2m', \ldots, x_0 + \prs{d-1}m'$.
\end{proposition}
\begin{proof}
\begin{description}
\item[כיוון ראשון:]
נניח שיש פתרונות ויהי
$x_0 \in \ZZ$
פתרון.
אז
$ax_0 \equiv b \mod{m}$
ולכן קיים
$y_0 \in \ZZ$
עבורו
$ax_0 - b = my_0$.
אז
$ax_0 -my_0 = b$.
נתון
$d \mid m,a$
לכן
$d \mid b$.
\item[כיוון שני:]
נניח כי
$d \mid b$.
קיימים
$x_0',y_0' \in \ZZ$
כך שמתקיים
$ax_0' - my_0' = d$.
יהי
$c = \frac{b}{d}$
ואז
$c\cdot d = b$.
לכן
$ax_0' - my_0'c = dc$.
יהי
$x_0 = x_0'c$
ואז
$ax_0 - my_0'c = b$
ומתקיים
$ax_0 \equiv b\mod{m}$
כנדרש.
\end{description}
\end{proof}
\begin{exercise}
כל שני פתרונות נבדלים בכפולה של
$m'$.
\end{exercise}

\begin{example}
נחזור לדוגמה מלמעלה,
$6x \equiv 9 \mod{15}$.
מתקיים
$\prs{6,15} = 3 \eqqcolon d$.
כאן
$b=9$
ומתקיים
$3 \mid 9$
כלומר
$d \mid b$
לכן מהטענה יש פתרונות.
אנו יודעים שיש
$3$
פתרונות מודולו
$15$.
$m' = \frac{m}{d} = 5$
לכן
$x_0 = 4, x_1 = 9, x_2 = 14$
הם כל הפתרונות.
\end{example}

\begin{corollary}
אם
$a,m$
זרים, יש בדיוק פתרון אחד למשוואה
$ax \equiv b\mod{m}$.
אם
$m=p$
ראשוני ו־%
$a \equiv 0 \mod{p}$,
למשוואה
$ax \equiv b\mod{p}$
יש פתרון יחיד.
\end{corollary}

\subsection{הפיכים ב־%
$\quot{\ZZ}{m\ZZ}$}
$a \in \quot{\ZZ}{m\ZZ}$
הוא הפיך ב־%
$\quot{\ZZ}{m\ZZ}$
אם ורק אם יש
$b \in \quot{\ZZ}{m\ZZ}$
כך שמתקיים
$ab = 1$,
כלומר יש פתרון למשוואה
$ax \equiv 1 \mod{m}$.
לפי הטענה, למשוואה יש פתרון אם ורק אם
$d = \prs{a,m}$
מחלק את
$1$,
כלומר
$d=1$,
ולכן קיבלנו ש־%
$\bar{a}$
הפיך.
לכן
$\prs{a,m} = 1$.
לכן, יש לנו בדיוק
$\phi\prs{m}$
הפיכים ב־%
$\quot{\ZZ}{m\ZZ}$,
כאשר
$\phi\prs{m}$
מספר השלמים הזרים ל־%
$m$
בין
$1$
ל־%
$m-1$.

\begin{example}
ב־%
$\quot{\ZZ}{12\ZZ}$
ההפיכים הם
$\set{1,5,7,11}$.
\end{example}
\begin{definition}
יהי
$R$
חוג עם יחידה ונסמן ב־%
$R^*$
את חבורת ההפיכים. זו חבורה לגבי כפל.
\end{definition}

\begin{example}
$\#\prs{\quot{\ZZ}{12\ZZ}}^* = 4$.
\end{example}
\begin{theorem}[\textenglish{Euler}]
אם
$\prs{a,m} = 1$
אז
$a^{\phi\prs{m}} \equiv 1 \mod{m}$.
\end{theorem}
\begin{theorem}[פרמה הקטן]
אם
$p$
ראשוני וגם
$p \nmid a$
אז
$a^{p-1} \equiv 1\mod{p}$.
\end{theorem}

נרצה להבין את
$\prs{\quot{\ZZ}{m\ZZ}}^*$.
האם חבורות אלו ציקליות? אם לא, מה המבנה שלהן כמכפלה ישרה של חבורות ציקליות?

\begin{example}
כל האיברים מסדר
$2$
מודולו
$12$
הם
$5,7,11$.
לכן, החבורה איננה ציקלית (אין איבר מסדר
$4$)
ולכן זאת חבורת קליין.
\end{example}

\begin{example}[משפט השאריות הסיני]
$\quot{\ZZ}{12\ZZ} \cong \quot{\ZZ}{3\ZZ}\oplus\quot{\ZZ}{4\ZZ}$.
\end{example}

\begin{example}
נסתכל על המשוואה
$x^2 + y^2 \equiv 3 \mod{35}$.
אם
$x_0, y_0$
פתרון אז
$35 \mid \prs{x_0^2 + y_0^2 - 3}$.
לכן
$5 \mid \prs{x_0^2 + y_0^3 - 3}$
וגם
$7 \mid \prs{x_0^2 + y_0^3 - 3}$.
לכן
$x_0^2 + y_0^2 \equiv 3 \mod{5}, \mod{7}$.
לכן
\begin{align*}
x_0 &\equiv 3 \mod{7} & x_0 &\equiv 2 \mod{5} \\
y_0 &\equiv 1 \mod{7} & y_0 &\equiv 2 \mod{5}
\end{align*}
ולכן
$x = 17, y = 22$
יפתרו את המשוואה
$x^2 + y^2 \equiv 3\mod{35}$.
\end{example}
\begin{lemma}
אם
$a_1, \ldots, a_k$
זרים ל־%
$m$
אז
$a_1\cdot\ldots\cdot a_k$
זר ל־%
$m$.
\end{lemma}

\begin{proof}
נציג שתי הוכחות.
\begin{enumerate}
\item
נראה שאם
$\prs{a,m} = 1$
ו־%
$\prs{b,m} = 1$
אז
$\prs{ab,m} = 1$.
נוכיח בדרך השלילה.
נניח כי
$\prs{ab,m}\neq 1$,
אז יש ראשוני
$p$
כך ש־%
$p \mid m,ab$.
לכן
$p \mid a$
או
$o \mid b$.
אבל, זו סתירה לכך ש־%
$\prs{a,m} = 1$
ו־%
$\prs{b,m} = 1$.\footnote{ההוכחה הכללית באינדוקציה}
\item
$a_1, \ldots, a_k$
זרים ל־%
$m$
לכן
הפיכים ב־%
$\quot{\ZZ}{m\ZZ}$.
אז
$\prod_{i=1}^k a_i$
הפיך ב־%
$\quot{\ZZ}{m\ZZ}$.
אבל,
איבר זה הפיך אם ורק אם הוא זר ל־%
$m$.
\end{enumerate}
\end{proof}

\begin{theorem}[משפט השאריות הסיני]
יהיו
$m_1, \ldots, m_k$
שלמים כך ש־%
$\prs{m_i, m_j} = 1$
עבור
$i \neq j$.
יהיו
$b_1,\ldots,b_k \in \ZZ$.
יהי
$m = \prod_{i=1}^k m_i$.
נסתכל על המשוואות
$x \equiv b_i \mod{m_i}$
לכל
$i \in [k]$.
למשוואות אלו תמיד יש פתרון, וכל שני פתרונות נבדלים בכפולה של
$m$.
\end{theorem}
\begin{proof}
נוכיח באינדוקציה על
$k$.
\begin{description}
\item[בסיס:]
אם יש משוואה אחת
$x \equiv b_1 \mod{m_1}$
אז
$x = b_1$
פתרון.
\item[צעד:]
נניח שיש
$x_1$
שלם הפותר את
$x_1 \equiv b_i \mod{m_i}$
לכל
$i \in \brs{k-1}$.
נרצה שגם
$x_1 \equiv b_k \prs{m_k}$,
אבל זה לא בטוח. אם לא, נחליף את
$x_1$.
יהי
$m' = \prod_{i=1}^{k-1} m_i$.
נסתכל על
$x_1 + ym'$
כאשר
$y \in \ZZ$.
נרצה
$x_1 + ym' \equiv b_k \mod{m_k}$.
לכן נחפש את
$y$
המתאים, כלומר נפתור
$m'y = b_k - x_1\prs{m_k}$.
מתקיים
$\prs{m_i, m_j} = 1$
לכל
$i \neq j$
ולכן לפי הלמה
$m'$
זר ל־%
$m_k$.
אז
$\prs{m',m_k} = 1$
ולפי הטענה יש פתרון.
\end{description}
\end{proof}

\begin{exercise}
כל שני פתרונות נבדלים בכופלה של
$m$.
\end{exercise}

נחזור לדוגמה ממקודם.
\begin{align*}
x^2 + y^2 &\equiv 3 \mod{7} & x^2 + y^2 &\equiv 3 \mod{5} & x^2 + y^2 &\equiv 3 \mod{35} 
\end{align*}

\begin{example}
ראינו כי
\begin{align*}
x_0 &\equiv 3 \mod{7} & x_0 &\equiv 2 \mod{5} \\
y_0 &\equiv 1 \mod{7} & y_0 &\equiv 2 \mod{5}
\end{align*}
ולפי משפט השאריות הסיני, יש פתרון משותף.
$5,7 \mid x^2 + y^2 - 3$
ו־%
$5,7$
זרים לכן
$35 \mid x^2 + y^2 - 3$
ונקבל
$x^2 + y^2 \equiv 3\mod{35}$.
\end{example}

\begin{corollary}
כדי לפתור משוואה בקונגרואנציה מספיק לפתור את המשוואה מודולו חזקות של ראשוניים.
\end{corollary}

\begin{definition}
נניח כי
$R_1, \ldots, R_n$
חוגים, ונגדיר
\[\bigoplus_{i=1}^n R_i \ceq \set{\prs{r_1, \ldots, r_n}}{\forall i\colon r_i \in R_i}\]
עם חיבור וכפל לפי רכיבים.
זהו חוג ונקרא
\stress{הסכום הישר של
$R_i$}.
\end{definition}

\begin{example}
נסתכל על
$\quot{\ZZ}{7\ZZ}$.
מתקיים
\begin{align*}
5^2 = 25 &\equiv 4 \mod{7} & 5^3 = 5\cdot 4 &\equiv 6\mod{7} & 5^4 = 5\cdot 6 &\equiv 2\mod{7} & 5^5 = 5\cdot 2 &\equiv 3\mod{7} & 5^6 &\equiv 1\mod{7}
\end{align*}
לכן
$5$
יוצר של
$\quot{\ZZ}{7\ZZ}$.
\end{example}

\begin{lemma}
יהי
$K$
שדה ויהי
$p\prs{x} \in K\brs{x}$
מדרגה
$n$.
אז ל־%
$p$
לכל היותר
$n$
שורשים שונים.
\end{lemma}
\begin{proof}
נניח בשלילה שיש
$n+1$
שורשים שונים. באינדוקציה נקבל
$p(x) = c \prod_{i=1}^n \prs{x-\alpha_i}$
ואז לאחר הצבת
$\alpha_{n+1}$
שום גורם לא מתאפס, בסתירה.
\end{proof}
\begin{remark}
הכיוון השני של משפט פרמה נכון. אם
$a \mid n$
לא מתקיים
$a^{n-1} \equiv 1 \mod{n}$.%
\newlecture{21 באוקטובר}%
{2018}
אבל,
יש מספרים עבור
אם
$\prs{a,n} = 1$
אז
$a^{n-1}\equiv 1$.
מספרים אלו נקראים מספרי
\textenglish{Carmichael}.
\end{remark}
\begin{corollary}
יהיו
$p_1,p_2 \in k\brs{x}$
מתוקנים מדרגה
$n$.
אם
$p_1\prs{\alpha_i} = p_2\prs{\alpha_i}$
עבור
$n$
איברים שונים
$\alpha_1, \ldots, \alpha_n \in k$
אז
$p_1 = p_2$.
\end{corollary}
\begin{proof}
נסתכל על הפולינום
$p(x) = p_1(x) - p_2(x)$.
אז ל־%
$p$
דרגה לכל היותר
$n-1$.
מתקיים
$p\prs{\alpha_i} = p_1\prs{\alpha_i} - p_2\prs{\alpha_2} = 0$
לכן יש
$n$
שורשים שונים, אבל דרגתו
$n-1$
לכן הינו פולינום האפס.
\end{proof}
\begin{proposition}
יהי
$p$
ראשוני. אז
$x^{p-1}-1 \equiv \prs{x-1}\prs{x-2}\ldots\prs{x-\prs{p-1}} \mod{p}$
\end{proposition}
\begin{proof}
יהיו
$f(x) = x^{p-1}-1$
ו־%
$g(x) = \prs{x-1}\prs{x-2}\ldots\prs{x-\prs{p-1}}$.
אז לכל
$a \in \ZZ_p^*$
מתקיים
$f(a) = 0$
ממשפט פרמה וגם
$g(a) = 0$
ומהמסקה
$g = f$.
\end{proof}
\begin{theorem}[\textenglish{Wilson}]
$\prs{p-1}! \equiv -1\mod{p}$.
\end{theorem}
\begin{proof}
נציב
$x=0$
בטענה.
\end{proof}
\begin{exercise}
אם
$n>4$
פריק אז
$\prs{n-1}! \equiv 0 \mod{n}$.
\end{exercise}
\begin{proposition}
יהי
$p$
ראשוני
ו־%
$d \in \NN$
עבורו
$d \mid p-1$.
אז לפולינום
$x^d - 1$
בדיוק
$d$
שורשים שונים מודולו
$p$.
\end{proposition}
\begin{proof}
יהא
$m = \frac{p-1}{d}$
ואז
$p-1 = dm$.
נקבל
\[\text{.}\frac{x^{p-1}-1}{x^d - 1} = \frac{\prs{x^d}^m - 1}{x^d - 1}\]
יהי
$y = x^d$.
אז
\[\frac{y^m - 1}{y-1} = 1+y+\ldots+y^{m-1}\]
ולכן
\begin{align*}
\frac{prs{x^d}^m - 1}{x^d - 1} = \overset{g(x)}{\overbrace{1 + x^d + \ldots + x^{\prs{m-1}d}}}
\end{align*}
ולאחר העברת אגפים
\[\text{.}x^{p-1} - 1 = \prs{x^d - 1}g(x)\]
לפי הטענה, לפולינום
$x^{p-1}-1$
יש
$p-1$
שורשים שונים, לכן לפולינום
$x^d - 1$
יש
$d$
שורשים שונים.
\end{proof}

תהי
$G$
אבלית מסדר
$n$.
נניח שלכל מחלק
$d \mid n$
יש בדיוק
$d$
איברים ב־%
$G$
שמקיימים
$x^d = e$.
אז ידוע מחבורות כי
$G$
חבורה ציקלית.

\begin{theorem}
$\ZZ_p$
ציקלית לכל
$p$
ראשוני.
\end{theorem}

\begin{proof}
הראינו שלכל
$d \mid p-1$
יש בדיוק
$d$
פתרונות למשוואה
$x^d - 1$
כלומר
$x^d = 1$.
\end{proof}

נוכיח שאם
$p \neq 2$
ראשוני אז
$\prs{\quot{\ZZ}{p^k \ZZ}}^*$
ציקלית לכל
$k$.
נתחיל עם המקרה
$k=2$.

נסתכל על החבורה
$\prs{\quot{\ZZ}{p\ZZ}}^*$.
ראינו כי זאת ציקלית, ולכן יש לה יותר
$g$.
הסדר של
$g$
הוא
$p-1$.
מתקיים
$\#\prs{\quot{\ZZ}{p^2\ZZ}}^* = p^2 - p$.
לכן אם
$p \nmid a$
אז
$a^{p^2 - p} \equiv 1 \mod{p^2}$.
גם
$g$
מקיים
$g^{p^2 - p} = 1 \mod{p^2}$.
יהי
$d = o(g)$
הסדר ב־%
$\prs{\quot{\ZZ}{p^2 \ZZ}}^*$.
אז
$p^2 \mid g^d - 1$
ולכן
$p \mid g^d - 1$
כלומר
$g^d \equiv 1 \mod{p}$.
לכן
$p-1 \mid d$.
גם
$d \mid \prs{p-1}p$
ולכן
$d = p-1$
או
$d = \prs{p-1}p$.
אם
$d = \prs{p-1}p$
סיימנו. אחרת נגדיר
$g_1 = g + p$.

\begin{proposition}
יהי
$g$
יוצר של החבורה
$\prs{\quot{\ZZ}{p\ZZ}}^*$
עבורו
$g^{p-1} \equiv 1 \mod{p^2}$.
אז
$g_1 = g + p$
יוצר של
$\prs{\quot{\ZZ}{p^2\ZZ}}^*$.
כלומר,
$g_1^{p-1} \not\equiv 1 \mod{p^2}$.\footnote{כי ראינו שהסדר של
$g_1$
צריך להיות
$p-1$
או
$\prs{p-1}p$}
\end{proposition}
\begin{proof}
\begin{align*}
g_1^{p-1} &= \prs{g + p}^{p-1} \\ &= \sum_{k=0}^{p-1} \binom{p-1}{k} g^{p-1-k}p^k \\ &\equiv
g^{p-1} + \prs{p-1}g^{p-2}p \mod{p^2} \\&\equiv 1 + \prs{p-1}g^{p-2}p \mod{p^2} \\&\neq 1 \mod{p^2}
\end{align*}
\phantom{י}
\end{proof}

מהטענה הוכחנו כי
$\prs{\quot{\ZZ}{p^k\ZZ}}^*$
ציקלית עבור
$k=2$.
נוכיח באופן כללי.
\\
ניקח
$g$
יוצר של
$\prs{\quot{\ZZ}{p^2 \ZZ}}^*$
ונראה שהוא יוצר של
$\prs{\quot{\ZZ}{p^k\ZZ}}^*$.
אז
$g$
יוצר גם של
$\prs{\quot{\ZZ}{p\ZZ}}^*$.
אז
$g^{p-1} = 1 + ap$
עם
$\prs{a,p} = 1$
(כי
$o(g) = p^2 - p > p-1$
מודולו
$p^2$).
ניקח איבר מהצורה
$1 + ap$
ונמצא את הסדר שלו ב־%
$\prs{\quot{\ZZ}{p^k \ZZ}}^*$.

\begin{lemma}
יהי
$p$
ראשוני ו־%
$1 \leq k \leq p-1$
שלם.
אז
$p \mid \binom{p}{k}$.
\end{lemma}
\begin{proof}
\[\binom{p}{k} = \frac{p!}{k! \prs{p-k}!}\]
כאשר
$p \nmid k!, \prs{p-k}!$.
לכן
$p \mid \binom{p}{k}$.
\end{proof}
\begin{lemma}
אם
$j \geq 1$
ואם
$a \equiv b \mod{p^j}$
אז
$a^p \equiv b^p \mod{p^{j+1}}$.
\end{lemma}
\begin{proof}
מתקיים
\[a = b + cp^j\]
עבור
$c \in \ZZ$.
כעת
\begin{align*}
a^p &= \prs{b+cp^j}^p \\
&= \sum_{k=0}^p \binom{p}{k}b^{p-k} \prs{cp^j}^k \\
&\equiv b^p + pb^{p-1}cp^j \\
&\equiv b^p + b^{p-1}cp^{j+1} \\
&\equiv b^p \mod{p^{j+1}} 
\end{align*}
כנדרש.
\end{proof}
\begin{corollary}
אם
$j \geq 2$
ו־%
$p \neq 2$
ראשוני אז
$\prs{1+ap}^{p^{j-2}} \equiv 1 + ap^{j-1} \mod{p^j}$.
\end{corollary}

\newlecture{22 בנובמבר}%
{2018}

\begin{proof}
נוכיח באינדוקציה על
$j$.

\begin{description}
\item[בסיס $j=2$:]

נקבל כי צריך להראות
\[1 + ap \equiv 1 + ap \mod{p^2}\]
וזה ברור.

\item[צעד:]
נניח שהטענה נכונה לכל
$j \leq k$
ונוכיח עבור
$j = k+1$.
צריך להוכיח
\[\text{.} \prs{a+ ap}^{p^{j-1}} \equiv 1 + ap^j \mod{p^{j+1}}\]
מתקיים מהלמה ומהנחת האינדוקציה
\[\text{.} \prs{1+ap}^{p^{j-1}} = \prs{\prs{1+ap}^{p^{j-2}}}^p \equiv \prs{1+ap^{j-1}}^p \mod{p^{j+1}}\]

לכן, כיוון ש־%
$j\geq 2$
גורר
$2\prs{j-1} \geq j$
נקבל כי
\begin{align*}
\prs{\prs{1+ap}^{j-1}}^p &\equiv 1 + p \cdot 1^{p-1} \cdot a \cdot p^{j-1} + \binom{p}{2} \cdot 1^{p-2} \cdot a^2 \cdot p^{2\prs{j-1}} + \ldots + a^p \cdot p^{p \prs{j-1}} \\&\equiv 1 + ap^j \mod{p^{j+1}}
\end{align*}

\end{description}
\end{proof}

\begin{definition}
יהיו
$a \in \ZZ, m \in \NN$
כך שמתקיים
$\gcd \prs{a,m} = 1$.
$a$
נקרא
\stress{שורש פרימיטיבי מוד
$m$}
אם
$\bar{a}$
יוצר את החבורה
$\prs{\quot{\ZZ}{m\ZZ}}^*$.
\end{definition}
\begin{example}
במקרה הקודם, הסדר של
$5$
מוד
$7$
הוא
$6$.
\end{example}

\begin{corollary}
אם
$\gcd\prs{a,p} = 1$
אז הסדר של
$1+ap$
מוד
$p^j$
עבור
$j\geq 2$
הוא
$p^{j-1}$.
\end{corollary}
\begin{proof}
נציב
$j+1$
בלמה ונקבל
\[\text{.}\prs{1+ap}^{p^{j-1}} \equiv 1 + ap^j \mod{p^{j+1}}\]
לכן
$p^{j+1}$
מחלק את ההפרש , ולכן גם
$p^j$
מחלק את ההפרש ונקבל
\[\text{.} \prs{1+ap}^{p^{j-1}} \equiv 1 \mod{p^j}\]
לכן הסדר של
$1+ap$
מוד
$p^j$
מחלק את זה מוד
$p^{j-1}$.
לכן הסדר בקבוצה
$\prs{1,p,\ldots, p^{j-1}}$.
מוד
$p^{j-2}$
נקבל
\[\prs{1+ap}^{p^{j-2}} \equiv 1 + ap^{j-1} \not\equiv 1 \mod{p^j}\]
ולכן הסדר הוא
$p^{j-1}$.
\end{proof}

\begin{theorem}
יהי
$k \geq 3$
ויהי
$p \neq 2$
ראשוני.
אז
$\prs{\quot{\ZZ}{p^k \ZZ}}^*$
ציקלית.
\end{theorem}

\begin{proof}
יהי
$g$
שורש פרימיטיב מוד
$p^2$
ונראה כי
$g$
שורש פרימיטיב מוד
$p^k$.
לפי פרמה הקטן,
$g^{p-1} \equiv 1 \mod{p}$
לכן
$g^{p-1} = 1 + ap$.
מצד שני
$g^{p-1} \neq 1 \mod{p^2}$
לכן
$\gcd\prs{a,p} = 1$.
יהי
$m$
הסדר של
$g$
מוד
$p^k$
ונרצה להוכיח
$m = p^k - p^{k-1}$.
כלומר
$m = p^{k-1}\prs{p-1}$.
נקבל
$g^m \equiv 1 \mod{p^k}$
ואז
$g^m \equiv 1 \mod{p}$
כלומר
$\prs{p-1} \mid m$,
כי
$g$
יוצר.
כעת
$g^m \equiv 1 \mod{p^k}$
גורר
$\prs{g^m}^{p-1} \equiv 1 \mod{p^k}$
לכן
$\prs{g^{p-1}}^{m} \equiv 1 \mod{p^k}$
לכן
$\prs{1+ap}^m \equiv 1 \mod{p^k}$
לכן
$p^{k-1} \mid m$
לכן
$p^{k-1} \cdot \prs{p-1} \mid m$
ולכן
$m = \prs{p-1}p^{k-1}$
כי זה הסדר של החבורה.
\end{proof}

\begin{proposition}
לכל
$j \geq 3$
מתקיים%
\newlecture{28 בנובמבר}%
{2018}%
$5^{2^{j-1}} \equiv 1 + 2^{j-1} \mod{2^j}$.
\end{proposition}
\begin{proof}
תרגיל, באינדוקציה.
\end{proof}
\begin{corollary}
הסדר של
$5$
ב־%
$\prs{\quot{\ZZ}{2\ZZ}}^*$
הוא
$2^{j-2}$.
\end{corollary}
\begin{proof}
$5^{2^{j-2}} \equiv 1 + 2^j \mod{2^{j+1}}$
לכן
$5^{2^{j-2}} = 1 + 2^j + a2^{j+1}$.
אז
$5^{2^{j-2}} \equiv 1 \mod{2^j}$.
מצד שני,
$5^{2^{j-3}} \equiv 1 + 2^{j-1} \mod{2^j}$
ובפרט
$5^{2^{j-3}} \not\equiv 1 \mod{2^j}$.
\end{proof}

\begin{theorem}
אם
$k \geq 3$
אז
\begin{align*}
\set{\prs{-1}^a 5^b}{\substack{a \in \set{0,1} \\ b \in \set{1,\ldots, 2^{k-2}}}}
\end{align*}
היא חתך של
$\prs{\quot{\ZZ}{2^k \ZZ}}^*$.
\end{theorem}
\begin{proof}
נניח כי
$\prs{-1}^{a_1} 5^{b_1} \equiv \prs{-1}^{a_2} 5^{b_2} \mod{2^k}$
כאשר
$a_1, a_2 \in \set{0,1}$,
$b_1,b_2 \in \set{1,\ldots, 2^{k-2}}$
ו־%
$k \geq 3$.
אז
\[\prs{-1}^{a_1} 5^{b_1} \equiv \prs{-1}^{a_2} 5^{b_2} \mod{4}\]
ולכן
\[\prs{-1}^{a_1} \equiv \prs{-1}^{a_2} \mod{4}\]
כלומר
$a_1 = a_2$.\footnote{כי לקחנו
$a_1, a_2 \in \set{0,1}$}
קיבלנו
$5^{b_1} \equiv 5^{b_2} \mod{2^k}$.
הסדר של
$5$
הוא
$2^{k-2}$
לפי המסקנה.
לכן השיוויון שקיבלנו גורר
$b_1 = b_2$.
מתקיים
$\# \prs{\quot{\ZZ}{2^k \ZZ}} = 2^{k-1}$
לכן אלו כל האיברים וזה אכן חתך.
\end{proof}

\begin{corollary}
תהא
$C_n$
חבורה ציקלית מסדר
$n$.
קיבלנו שאם
$k \geq 3$
אז
$\prs{\quot{\ZZ}{2^k\ZZ}}^* \cong C_2 \times C_{2^{k-2}}$.
\end{corollary}

\begin{remark}
$C_n \times C_m$
ציקלית אם ורק אם
$\prs{n,m}$
זרים.
\\
יהי
$m = \prod_{i=1}^r p_i^{k_i}$
פירוק לראשוניים של
$m$,
אז
\begin{align*}
\prs{\quot{\ZZ}{m\ZZ}}^* = \prs{\quot{\ZZ}{\prs{\prod_{i=1}^r p_i^{k_i}} \ZZ}}^* \stackrel[\text{CRT}]{}{\cong} \prod_{i=1}^r \prs{\quot{\ZZ}{p_i^{k_i}}}^*
\end{align*}
\end{remark}

\begin{corollary}
$\prs{\quot{\ZZ}{m\ZZ}}^*$
ציקלית אם
$m$
הוא
$2$, $4$,
$p^k$
או
$2p^k$
עבור
$p \neq 2$.
\end{corollary}

נזכיר את הניסוח האחרון שלנו לשאלות של פרמה.
עבור
$a \in \ZZ$
המקיים
$\gcd \prs{a,p} = 1$,
האם יש פתרון למשוואה
$z^2 \equiv a \mod{p}$?
ראינו כי
$\prs{\quot{\ZZ}{p\ZZ}}^*$
ציקלית ולכן נסתכל על משוואות מהצורה
$g^2 = a$
בחבורות ציקליות.

\begin{theorem}
תהי
$G$
חבורה ציקלית מסדר
$n$.%
\newlecture{29 בנובמבר}%
{2018}%
יהי
$a \in G$.
\begin{enumerate}
\item
אם
$n$
אי־זוגי, קיים
$x$
יחיד ב־%
$G$
עבורו
$x^2 = a$
\item
אם
$n$
זוגי, קיים
$x$
ב־%
$G$
כך ש־%
$x^2 = a$
אם ורק אם
$a^{\frac{n}{2}} = 1$
ובמקרה זה יש בדיוק
$2$
פתרונות.
\end{enumerate}
\end{theorem}

\begin{proof}
נסתכל על ההומומורפיזם
\begin{align*}
\Phi \colon G &\to G \\
x &\to x^2
\end{align*}
(זה הומומורפיזם כי
$G$
אבלית).
\begin{enumerate}
\item
אם
$n$
אי־זוגי, אין איבר מסדר שתיים לכן הגרעין של
$\Phi$
טריוואלי, לכן ההעתקה חח"ע ולכן על.

\item
אם
$n$
זוגי אז
$\# \ker \Phi = 2$.%
\footnote{ראינו שבחבורה ציקלית למשוואה
$x^d = 1$
יש בדיוק
$d$
פתרונות לכל
$d \mid n = \# G$}%
אז
$\# \im\Phi = \frac{\# G}{\# \ker \Phi} = \frac{n}{2}$.\\
אם קיים
$x$
עבורו
$x^2 = a$,
נעלה את שני האגפים בחזקת
$\frac{n}{2}$
ואז
$a^{\frac{n}{2}} = 1$.
אם
$a^{\frac{n}{2}} = 1$
אז
$a$
פתרון של
$x^{\frac{n}{2}} = 1$
ויש בדיוק
$\frac{n}{2}$
פתרונות כאלה שהם
$\im\Phi$:
אם
$y \in \im \Phi$
קיים
$x \in G$
עבורו
$x^2 = y$
ואז
$y^{\frac{n}{2}} = x^n = 1$.
לכן
$a \in \im\Phi$.
\end{enumerate}
\end{proof}
\begin{definition}
יהי
$a \in \ZZ$
ויהי
$m \in \NN$.
$a$
הוא
\stress{שארית ריבועית}
מודולו
$m$
אם קיים
$x \in \ZZ$
עבורו
$x^2 \equiv a \mod{m}$.
\end{definition}
\begin{corollary}
יהי
$p\neq 2$
ראשוני ויהי
$a \in \ZZ$
עבורו
$\gcd\prs{a,p} = 1$.
אז
$a$
הוא שארית ריבועית מודולו
$p$
אם ורק אם
$a^{\frac{p-1}{2}} \equiv 1 \mod{p}$.
\end{corollary}
\begin{proof}
$\# \prs{\quot{\ZZ}{p\ZZ}} = p-1 \eqqcolon n$
זוגי לכן יש פתרון למשוואה
$x^2 \equiv a \mod{p}$
אם ורק אם
$a^{\frac{n}{2}} = a^{\frac{p-1}{2}} \equiv 1 \mod{p}$.
\end{proof}

\begin{corollary}
יהי
$p \neq 2$
ראשוני.
$-1$
הוא שארית ריבועית מודולו
$p$
אם ורק אם
$p \equiv 1 \mod{4}$.
\end{corollary}
\begin{proof}
$-1$
שארית ריבועית מודולו
$p$
אם ורק אם
$\prs{-1}^{\frac{p-1}{2}} \equiv 1 \mod{p}$
אם ורק אם
$\frac{p-1}{2}$
זוגי אם ורק אם קיים
$k \in \ZZ$
עבורו
$p-1 = 4k$
אם ורק אם
$p \equiv 1 \mod{4}$.
\end{proof}
\begin{remark}
לכל
$a$,
$a^{\frac{p-1}{2}}$
איבר מסדר
$2$
מודולו
$p$
לכן הינו
$\pm 1$.
\end{remark}
\begin{example}
\[\prs{-3}^{\frac{4}{2}} = 9 \equiv -1\mod{5}\]
לכן
$-3$
אינו שארית ריבועית מודולו
$5$.
\end{example}
\begin{example}
\[\prs{-3}^{\frac{6}{2}} = -27 = -28+1 \equiv 1 \mod{7}\]
לכן
$-3$
הינו שארית ריבועית מוולו
$7$.
\end{example}
\begin{example}
\[\prs{-3}^{\frac{11-1}{2}} = -3^5 \equiv -1 \mod{11}\]
לכן
$-3$
אינו שארית ריבועית מודולו
$11$.
\end{example}

\section{המשוואה
$x^k = a$
בחבורה ציקלית}

\begin{theorem}
תהי
$G$
חבורה ציקלית מסדר
$n$
ויהי
$a \in G$.
נסתכל על המשוואה
$x^k = a$.
\begin{enumerate}
\item אם
$\gcd\prs{k,n} = 1$,
קיים
$x \in G$
יחידה עבורו
$x^k = a$.
\item אם
$k \mid n$
יהי
$r = \frac{n}{k}$.
קיים
$x$
ב־%
$G$
כך ש־%
$x^k = a$
אם ורק אם
$a^r = 1$.
אז יש בדיוק
$k$
פתרונות.
\label{x^k=a:iff}
\end{enumerate}
\end{theorem}

\begin{remark}
כדי להוכיח את המשפט מסתכלים על ההומומורפיזם
\begin{align*}
\Phi \colon G &\to G
\text{.} \phantom{\Phi} \colon x &\to x^k
\end{align*}
עשינו דבר דומה עבור
$k=2$.
\end{remark}
\begin{proof}
נציג הוכחה לחלק \ref{x^k=a:iff} של המשפט בלבד.

לכיוון אחד, נניח שקיים
$x \in a$
עבורו
$x^k = a$.
אז
\[\text{.}a^r = \prs{x^k}^r = x^{k \frac{n}{d}} = x^{\frac{k}{d}n} = \prs{x^{\frac{k}{d}}}^n = 1\]

להפך, נניח כי
$a^r = 1$
ונמצא
$x \in G$
עבורו
$x^k = a$.
מההנחה,
ומהסעיף הראשון, קיים
$x \in G$
עבורו
$x^d = a$.
יש
$\alpha,\beta \in \ZZ$
כך שמתקיים
$\alpha k +\beta n = d$.
אז
\[a = x^d = x^{\alpha k + \beta n} = \prs{x^{\alpha}}^k \prs{x^{\beta}}^n = \prs{x^{\alpha}}^k\]
ולכן
$a = y^k$
עבור
$y = x^{\alpha}$.
\end{proof}

בהמשך נרצה להסתכל על המשוואות
$x^3 \equiv a \mod{p}$
ו־%
$x^4 \equiv a \mod{p}$
כאשר
$\prs{a,p} = 1$.

\begin{example}
נסתכל על
$k = 3$
ועל
$G = \prs{\quot{\ZZ}{p\ZZ}}^*$.
\begin{enumerate}
\item אם
$3 \nmid p-1$
מתקיים
$\prs{3,p-1} = 1$
לכן
$p \equiv 2 \mod{3}$
תמיד יש פתרון יחיד למשוואה
$x3 \equiv a \mod{p}$.
\item אם 
$3 \mid p-1$
אז
$p \equiv 1\mod{3}$.
שליש מהאיברים הם חזקה שלישית כי
$x^3 \equiv a \mod{p}$
אם ורק אם
$a^{\frac{p-1}{3}} \equiv 1 \mod{p}$.
\end{enumerate}
\end{example}

\begin{example}
נסתכל על
$x^4 \equiv a \mod{p}$.
נניח כי
$p \not \equiv 2$
ואז
$p-1$
זוגי. לכן
$\gcd\prs{4,p-1} \in \set{2,4}$.
$p \equiv 1 \mod{4}$
אם ורק אם
$4 \mid \prs{p-1}$
ו־%
$p \equiv 3 \mod{4}$
אם ורק אם
$2 \mid \prs{p-1}$
ו־%
$4 \nmid \prs{p-1}$.
לכן לרבע מהאיברים יש שורש רביעי.
\[a^{\frac{p-1}{4}} \equiv 1 \mod{p} \iff x^4 \equiv a \mod{p}\]
\end{example}

\section{הרמה של פתרונות ממודולו
$p$
למודולו
$p^k$}
\begin{proposition}
יהי
$p \neq 2$
ראשוני ויהיו
$a,k$
זרים ל־%
$p$.
אם יש פתרון למשוואה
$x^k \equiv a \mod{p}$
אז יש פתרון למשוואה
$x^k \equiv a \mod{p^e}$
לכל
$e \in \NN_+$.
\end{proposition}
\begin{proof}
באינדוקציה על
$e$.
\begin{description}
\item[בסיס:]
$e=1$
טריוויאלי.
\item[צעד:]
נניח כי
$x_0$
פתרון ל־%
$x^k \equiv a\mod{p^e}$
ונמצא פתרון למשוואה
$x^k \equiv a \mod{p^{e+1}}$.
ניקח
$x = x_0 + bp^e$.
אז
\[\text{.}x^k = \prs{x_0 + bp^e}^k = \sum_{i=0}^k x_0^i \prs{bp^e}^{k-i} \equiv x_0^k + kx_0^{k-1}bp^e \mod{p^{e+1}}\]
ידוע מהגדרת
$x_0$
כי
$x_0^k = a + cp$
לכן
\begin{align*}
x^k \equiv a + cp^e + kx_0^{k-1}bp^e \mod{p^{e-1}} \equiv a + p^e \prs{c + kx_0^{k-1}b}\mod{p^{e+1}}
\end{align*}
ולכן צריך
$c + \overset{\alpha}{\overbrace{kx_0^{k-1}}} \cdot \overset{y}{\overbrace{b}} \equiv 0 \mod{p}$.
כעת
$\gcd\prs{x_0, p} = 1$
כי
$x_0^k \equiv a \mod{p^e}$
אבל
$a$
זר ל־%
$p$
ולכן גם
$x_0$.
בנוסף,
$\gcd\prs{k,p} = 1$
ולכן יש פתרון ל־%
$c + \alpha y \equiv 0 \mod{p}$.
כלומר, יש
$b$
עבורו
$x = x_0 + b^e$,
כנדרש.
\end{description}
\end{proof}

\begin{proposition}
יהי
$a$
אי־זוגי ויהי
$e \geq 3$.
\newlecture{12 בדצמבר}%
{2018}
למשוואה
$x^n \equiv 2 \mod{2^e}$
יש פתרון אם ורק אם מתקיים לפחות אחד התנאים הבאים.
\begin{enumerate}
\item
$n$
אי־זוגי
\item
$a \equiv 1 \mod{4}$
ו־%
$a^{\frac{2^{e-2}}{d}} \equiv \prs{2^e}$
כאשר
$d = \gcd{n, 2^{e-2}}$
\end{enumerate}
\end{proposition}
\begin{proof}
משתמשים במבנה של החבורה
\[\text{.}\prs{\quot{\ZZ}{2^e \ZZ}}^* \cong C_2 \times C_{2^{e - 2}}\]
\end{proof}

\begin{definition}
אם
$\gcd\prs{a,m} = 1$
אז
$a$
\stress{שארית ריבועית מודולו
$m$}
אם קיים
$x \in \ZZ$
עבורו
$x^2 \equiv a \mod{m}$.
\end{definition}

\begin{proposition}
יהי
$m = 2^e \prod_{i \in [k]} p_i^{e_i}$
ונניח
$\gcd\prs{a,m} = 1$.
אז
$a$
שארית ריבועית מודולו
$m$
אם ורק אם מתקיימות שתי התכונות הבאות.
\begin{enumerate}
\item $a^{\frac{p_i - 1}{2}} \equiv 1 \mod{p_i}$
לכל
$i \in [k]$.
\item אם
$e = 2$
אז
$a \equiv 1 \mod{4}$.
אם
$e \geq 3$
אז
$a \equiv 1 \mod{8}$.
\end{enumerate}
\end{proposition}
\begin{proof}
ממשפט השאריות הסיני, די לפתור
$x^2 \equiv a \mod{p_i}$.
וגם
$x^2 \equiv a\mod{2^e}$.
\\
נזכיר כי אם
$\gcd\prs{a,p} = 1$
אז
$a$
שארית ריבועית מודולו
$p$
אם ורק אם
$a^{\frac{p-1}{2}} \equiv 1$.\\
על מנת להמשיך את ההוכחה, ניעזר בהגדרה.

נסתכל כעת על
$p$
ראשוני אי־זוגי.

\begin{definition}[סימן
\textenglish{Legendre}]
יהיי
$a \in \ZZ$
ויהי
$p\neq 2 \in \ZZ$
ראשוני.
נסמן
$\prs{\frac{a}{p}}$
\stress{סימן \textenglish{Legendre}}
שערכו
\begin{itemize}
\item $1$
אם
$a$
שארית ריבועית מודולו
$p$
\item $-1$
אם
$\gcd\prs{a,p} = 1$
ו־%
$a$
אינו שארית ריבועית מודולו
$p$
\item $0$
אם
$p \mid a$
\end{itemize}
\end{definition}

\begin{theorem}
\begin{enumerate}
\item $a^{\frac{p-1}{2}} \equiv \prs{\frac{a}{p}} \mod{p}$
\item $\prs{\frac{ab}{p}} = \prs{\frac{a}{p}} \prs{\frac{b}{p}}$
\item אם
$a \equiv b \mod{p}$
אז
$\prs{\frac{a}{p}} = \prs{\frac{b}{p}}$.
\end{enumerate}
\end{theorem}
\begin{proof}
\begin{enumerate}
\item אם
$a$
שארית ריבועית מודולו
$p$
ראינו
$a^{\frac{p-1}{2}} \equiv 1 \mod{p}$
והגדרנו
$\prs{\frac{a}{p}} = 1$.

אם
$p \mid a$
אז
$a^{\frac{p-1}{2}} \equiv 0 \equiv \prs{\frac{a}{p}} \mod{p}$

אחרת,
$a$
אינו שארית ריבועית מודולו
$p$
ומהמשפט
$c \ceq a^{\frac{p-1}{2}} \not\equiv 1 \mod{p}$.
אז
$c^2 = a^{p-1} \equiv 1 \mod{p}$
לכן
$c = -1$.%
\footnote{אנו מעל שדה, לכן יש שני פתרונות}
כלומר,
$a^{\frac{p-1}{2}} \equiv -1 \equiv \prs{\frac{a}{p}} \mod{p}$.

\item %2
לפי הסעיף הקודם,
\[\text{.} \prs{\frac{ab}{p}} \equiv \prs{ab}^{\frac{p-1}{2}} \equiv a^{\frac{p-1}{2}} b^{\frac{p-1}{2}} \equiv \prs{\frac{a}{p}} \prs{\frac{b}{p}} \mod{p}\]

\item %3
לפי הסעיף הראשון,
\[\text{.} \prs{\frac{a}{p}} \equiv a^{\frac{p-1}{2}} \equiv b^{\frac{p-1}{2}} \equiv \prs{\frac{b}{p}} \mod{p}\]
\end{enumerate}
\end{proof}
סוף המשפט לא הוכח במהלך ההרצאות (ייתכן כי הינו מופיע ברשימות התרגולים).
\end{proof}

\chapter{הדדיות ריבועית}
\begin{theorem}[הדדיות ריבועית]
יהיו
$p,q$
ראשוניים אי־זוגיים שונים.
\begin{enumerate}
\item $\prs{\frac{-1}{p}} = \prs{-1}^{\frac{p-1}{2}}$
\item $\prs{\frac{2}{p}} = \prs{-1}^{\frac{p^2 - 1}{8}}$
\item $\prs{\frac{p}{q}} \prs{\frac{q}{p}} = \prs{-1}^{{\frac{p-1}{2}}\cdot {\frac{q-1}{2}}}$
\end{enumerate}
\end{theorem}
\begin{corollary}
\begin{enumerate}
\item $-1$
שארית ריבועית מודולו
$p$
אם ורק אם
$p \equiv 1 \mod{4}$.
\item $2$
שארית ריבועית מודולו
$p$
אם ורק אם
$p \equiv \pm 1 \mod{8}$.
\item אם
$p \equiv 1 \mod{4}$
או
$q \equiv 1 \mod{4}$
אז
$\prs{\frac{p}{q}} = \prs{\frac{q}{p}}$.\\
אם
$p \equiv 3 \mod{4}$
או
$q \equiv 3 \mod{4}$
אז
$\prs{\frac{p}{q}} = -\prs{\frac{q}{p}}$.
\end{enumerate}
\end{corollary}
\begin{proof}[של המסקנה]
\begin{enumerate}
\item אם
$p \equiv 1 \mod{4}$
אז
$p = 4k + 1$
ואז
$\frac{p-1}{2} = 2k$
ואכן
$\prs{-1}^{2k} = 1$.\\
אם
$p \equiv \pm 3 \mod{4}$
אז
$p = 8k + 1$
ואז
\[\frac{p^2 - 1}{8} = \frac{64 k^2 \pm 16k}{8} = 8k^2 \pm 2k \in \ZZ\]
אחרת
$p \equiv \pm 3 \mod{8}$
ואז
$\prs{-1}^{\frac{p^2 - 1}{8}} \equiv - 1$
ואז
$\prs{-1}^{\frac{p^2 - 1}{8}} \equiv 1$.
\end{enumerate}
\end{proof}

ראינו בעצם כי עבור
$a \in [3]$
יש פתרוןל ל־%
$x^2 + ay^2 = p$
אם ורק אם
$\prs{\frac{-a}{p}} = 1$.

\begin{theorem}[אוילר]
יהי
$p \neq 2$
ראשוני. קיימים
$x,y \in \ZZ$
עבורם
$x^2 + 2y^2 = p$
אם ורק אם
$p \in \set{1,3} \mod{8}$.
\end{theorem}


\begin{theorem}[אוילר]
יהי
$p \neq 3$
ראשוני. קיימים
$x,y \in \ZZ$
עבורם
$x^2 + 3y^2 = p$
אם ורק אם
$p \equiv 1\ mod{3}$.
\end{theorem}
\begin{proof}
נכתוב
\begin{align*}
\prs{\frac{-3}{p}} &= \prs{\frac{-1}{p}} \prs{\frac{3}{p}} \\
&= \prs{-1}^{\frac{p-1}{2}} \prs{-1}^{\frac{p-1}{2} \cdot \frac{3-1}{2}} \prs{\frac{p}{3}}
\\&= \prs{-1}^{\frac{p-1}{2}} \prs{-1}^{\frac{p-1}{2}} \prs{\frac{p}3{}} \\&= \prs{\frac{p}{3}}
\end{align*}
\end{proof}

\begin{example}
\[\prs{\frac{17}{47}} = \pmat{\frac{47}{17}} = \prs{\frac{13}{17}} = \prs{\frac{17}{13}} = \prs{\frac{4}{13}} = 1\]
\end{example}

\begin{example}

אם
$x^2 + 5y^2 = p$
אז
$\prs{\frac{-5}{p}} = 1$
כאשר
$p \neq 5$. \newlecture{13 בדצמבר}%
{2018}
באותו אופן עבור
$n$
כללי
\[x^2 + ny^2 = p\]
ולכן
$\prs{\frac{-n}{p}} = 1$.
נרצה לדעת מתי
$\prs{\frac{-5}{p}} = 1$.
מתקיים מהדדיות
\[\text{.} \prs{\frac{-5}{p}} = \prs{\frac{-1}{p}} \cdot \prs{\frac{5}{p}} = \prs{-1}^{\frac{p-1}{2}} \cdot \prs{\frac{p}{5}}\]
לכן
$1,4$
ריבועים מודולו
$5$
ו־%
$2,3$
אינם ריבועים מודולו
$5$.
עתה
$\prs{\frac{-5}{p}} = 1$
אם ורק אם
מתקיים אחד המשפטים הבאים.
\begin{enumerate}
\item  גם
$p \equiv 1 \mod{4}$
וגם
$p \equiv \pm 1 \mod{5}$.
\item 
$p \equiv 3 \mod{4}$
וגם
$p \equiv \pm 2 \mod{5}$.
\end{enumerate}
לכן, לפי משפט השאריות הסיני,
$p \equiv 1,3,7,9 \mod {20}$
ולכן קיבלנו כי
$\prs{\frac{-5}{p}} = 1$
אם ורק אם
$p = 1,3,7,9$.
\end{example}

\begin{theorem}[לגרנג']
יהי
$p$
ראשוני שונה מ־%
$5$.
קיימים
$x,y \in \ZZ$
כך ש־%
$x^2 + 5y^2 = p$,
אם ורק אם
$p \equiv 1,9 \mod{20}$.
\end{theorem}
\begin{remark}
מהמשפט, אם
$5$
שארית ריבועית מודולו
$5$,
לא בהכרח פתרון מהצורה
$x^2 + 5y^2 = p$.
\\
עבור
$p \equiv 3,7 \mod{20}$,
לא ניתן להציג את
$p$
באמצעות
$x^2 + 5y^2$.\\
נחשוב מה הסיבה לכך.
עבור
$x^2 + ay^2 = p$
עבדנו עם
$\ZZ\brs{\sqrt{-a}}$
אבל כאשר
$a = 5$
החוג אינו אוקלידי ואפילו אינו
\textenglish{PID}.
\end{remark}

\begin{definition}
יהי
$b$
אי־זוגי חיובי ויהי
$a \in \ZZ$.
נניח כי
$b = p_1 \cdot \ldots \cdot p_k$
פירוק לראשוניים, ונגדיר את
\stress{סימן יעקובי}
\begin{align*}
\text{.} \prs{\frac{a}{b}} = \prs{\frac{a}{p_1}} \prs{\frac{a}{p_2}} \cdot \ldots \cdot \prs{\frac{a}{p_k}}
\end{align*}
\end{definition}
\begin{remark}
אם
$b$
ראשוני, סימן יעקובי וסימן לז'נדר מזדהים.
\end{remark}
\begin{remark}
\begin{itemize}
\item סימן יעקובי מוגדר היטב, כי בפירוק של
$b$
לא מופיע
$2$,
וסימן לז'נדר מוגדר עבור
$p \neq 2$.
\item אם
$b$
אינו ראשוני,
$\prs{\frac{a}{b}}$
אינו בהכרח בודק אם
$a$
שארית ריבועית מודולו
$b$.
\end{itemize}
\end{remark}

\begin{example}
מתקיים
\[\prs{\frac{2}{15}} = \prs{\frac{2}{3}}\prs{\frac{2}{5}} = 1\]
$2$
אינו שארית ריבועית מודולו
$3$
או מודולו
$5$
לכן
$\prs{\frac{2}{3}}\cdot\prs{\frac{2}{5}} = 1$,
אבל
$2$
אינו שארית ריבועית מודולו
$5$
כי אינו שארית ריבועית מודולו
$3,5$.
\end{example}

\begin{remark}
מה שטוב בסימן יעקובי הוא שלא צריך לפרק את המספרים כפי שראינו בדוגמה עם
$\prs{\frac{17}{47}}$.
נרצה להראות שלסימן יעקובי אותן תכונות של סימן לג'נדר, ובפרט הדדיות.
\end{remark}

\begin{proposition}
\begin{enumerate}
\item \[\prs{\frac{a_1 a_2}{b}} = \prs{\frac{a_1}{b}} \cdot \prs{\frac{a_2}{b}}\]
\item \[\prs{\frac{a}{b_1 b_2}} = \prs{\frac{a}{b_1}} \cdot\prs{\frac{a}{b_2}}\]
\item אם
$a_1 \equiv a_2 \mod{b}$
אז
\[\prs{\frac{a_1}{b}} = \prs{\frac{a_2}{b}}\]
\end{enumerate}
\end{proposition}

\begin{proof}
\begin{enumerate}
\item %1
\begin{align*}
\prs{\frac{a_1 a_2}{b}} &= \prs{\frac{a_1 a_2}{p_1 \cdot \ldots \cdot p_k}} \\&=
\prs{\frac{a_1 a_2}{p_1}} \cdot \ldots \cdot \prs{\frac{a_1 a_2}{p_k}} \\&=
\prs{\frac{a_1}{p_1}}\prs{\frac{a_2}{p_1}} \cdot \ldots \cdot  \prs{\frac{a_1}{p_k}}\prs{\frac{a_2}{p_k}} \\&=
\prs{\frac{a_1}{p_1 \cdot \ldots \cdot p_k}} \cdot \prs{\frac{a_2}{p_1 \cdot \ldots \cdot p_k}} \\&= \prs{\frac{a_1}{b}} \cdot \prs{\frac{a_2}{b}}
\end{align*}

\item %2
מיידי מההגדרה.

\item %3
אם
$a_1 \equiv a_2 \mod{b}$
אז בפרט
$a_1 \equiv a_2 \mod{p_i}$
לכל
$p_i$
בפירוק של
$b$,
ומכאן ממשיכים עם התכונות של סימן לז'נדר.
\end{enumerate}
\end{proof}

\begin{lemma} \label{jacobi-lemma}
יהיו
$r,s$
אי־זוגיים. אז
\begin{enumerate}
\item \[\frac{rs - 1}{2} = \frac{r-1}{2} + \frac{s-1}{2} \mod{2}\] \label{jacobi-lemma:formula}
\item \[\frac{r^2 s^2 - 1}{8} = \frac{r^2 - 1}{8} + \frac{s^2 - 1}{8} \mod{2}\] \label{jacobi-lemma:square-formula}
\end{enumerate}
\end{lemma}

\begin{remark}
אם
$a$
אי־זוגי אז
$a^2 \equiv 1\mod{8}$
כי
$a^2 - 1 = \prs{a-1} \prs{a+1}$
ואז
$\prs{a+1},\prs{a-1}$
זוגיים ולכן המכפלה מתחלקת ב־%
$4$.
\end{remark}

\begin{proof}
\begin{enumerate}
\item \begin{align*}
\prs{r-1}\prs{s-1}&\equiv 0 \mod{4} \\
rs - r - s + 1 &\equiv 0 \mod{4} \\
rs - 1 &\equiv r - 1 + s - 1 \mod{4} \\
\frac{rs - 1}{2} &\equiv \frac{r-1}{2} + \frac{s-1}{2} \mod{2}
\end{align*}
\item
\begin{align*}
\prs{r^2 - 1}\prs{s^2 - 1} &\equiv 0 \mod{16} \\
r^2 s^2 - 1 &\equiv r^2 - 1 + s^2 - 1 \mod{16} \\
\frac{r^2 s^2 - 1}{8} &\equiv \frac{r^2 - 1}{8} + \frac{s^2 - 1}{8} \mod{2}
\end{align*}
\end{enumerate}
\end{proof}

\begin{corollary}
יהיו
$r_!, \ldots, r_k$
אי־זוגיים. אז
\begin{enumerate}
\item
\begin{align*}
\sum_{i \in [k]} \frac{r_i - 1}{2} \equiv \frac{r_1 \cdot \ldots r_k - 1}{2} \mod{2}
\end{align*}
\item 
\begin{align*}
\sum_{i \in [k]} \frac{r_i^2 - 1}{8} \equiv \frac{r_1^2 \cdot \ldots r_k^2 - 1}{8} \mod{2}
\end{align*}
\end{enumerate}
\end{corollary}
\begin{proof}
נוכיח את הסעיף הראשון באינדוקציה.
\begin{align*}
\sum_{i \in [k-1]} \frac{r_i - 1}{2} &\equiv \frac{r_1 \cdot \ldots r_{k-1} - 1}{2} \mod{2}
\end{align*}
נגדיר
$a = r_1 \cdot \ldots \cdot r_{k-1}$
ואז מלמה
\ref{jacobi-lemma}
סעיף
\ref{jacobi-lemma:formula}
נקבל
\[\frac{a-1}{2} + \frac{r_k - 1}{2} \equiv \frac{a r_k - 1}{2} \equiv \frac{r_1 \cdot \ldots r_k - 1}{2} \mod{2}\]
כנדרש.

את הסעיף השני נוכיח באותו אופן.
\end{proof}

\begin{theorem}
יהי
$b$
שלם חיובי ואי־זוגי.
\begin{enumerate}
\item
\[\prs{\frac{-1}{b}} = \prs{-1}^{\frac{b-1}{2}}\]
\item
\[\prs{\frac{2}{b}} = \prs{-1}^{\frac{b^2 - 1}{8}}\]
\item
אם
$a\neq 1$
אי זוגי ו־%
$\prs{a,b} = 1$
אז
\[\prs{\frac{a}{b}} = \prs{\frac{b}{a}} = \prs{-1}^{\frac{a-1}{2} \cdot \frac{b-1}{2}}\]
\end{enumerate}
\end{theorem}
\begin{proof}
\begin{enumerate}
\item %1
\begin{align*}
\prs{\frac{-1}{b}} &= \prs{\frac{-1}{p_1}} \cdot \ldots \prs{\frac{-1}{p_k}} \\&=
\prs{-1}^{\frac{p_1 - 1}{2} + \ldots + \frac{p_k - 1}{2}} \\ &\stackrel[\text{previous lemma}]{}{=} \prs{-1}^{\frac{p_1 \cdot \ldots \cdot p_k - 1}{2}} \\&= \prs{-1}^{\frac{b-1}{2}}
\end{align*}
\item %2
באותה דרך כמו הסעיף הקודם.

\item %3
נכתוב
$a = q_1 \cdot \ldots \cdot q_m$.
מתקיים
\begin{align*}
\prs{\frac{a}{b}} \prs{\frac{b}{a}} &= \prod_{i,j} \prs{\frac{p_i}{q_j}} \prs{\frac{q_j}{p_i}} \\&= \prod_{i,j} \prs{-1}^{\frac{p_i - 1}{2} \cdot \frac{q_j - 1}{2}} \\&=
\prs{-1}^{\sum_{i,j} \frac{p_i - 1}{2} \cdot \frac{q_j - 1}{2}} \\&=
\prs{-1}^{\prs{\sum_{i \in [k]} \frac{p_i - 1}{2}}\prs{\sum_{j \in [m]} \frac{q_j - 1}{2}}} \\&\stackrel[\text{from corollary}]{}{=}
\prs{-1}^{\frac{p_1 \cdot \ldots \cdot p_k - 1}{2} \cdot \frac{q_1 \cdot \ldots \cdot q_m - 1}{2}} \\&=
\prs{-1}^{\frac{b-1}{2} \cdot \frac{a-1}{2}}
\end{align*}
\end{enumerate}
\end{proof}

\begin{example}
נרצה לחשב את
$\prs{\frac{1001}{9907}}$.\\
דרך אחת היא פירוק
$1001 = 7 \cdot 11 \cdot 13$
ואז חישוב כמכפלת סימני לג'נדר.
\\
דרך נוספת היא עם סימן יעקובי.
\begin{align*}
\prs{\frac{1001}{9907}} &= \prs{\frac{9907}{1001}} \\&= \prs{\frac{898}{1001}} =
\prs{\frac{2}{1001}}\prs{\frac{449}{1001}} \\&=
\prs{-1}^{\frac{1001^2 - 1}{8}} \prs{\frac{449}{1001}} =
\prs{\frac{1001}{449}} \\&=
\prs{\frac{103}{449}} =
\prs{\frac{449}{103}} \\&=
\prs{\frac{37}{103}} =
\prs{\frac{103}{37}} \\&=
\prs{\frac{29}{37}} =
\prs{\frac{37}{29}} \\&=
\prs{\frac{8}{29}} = \prs{\frac{4}{29}} \cdot \prs{\frac{2}{29}}\\&=
\prs{\frac{2}{29}} = - 1
\end{align*}
\end{example}

\section{אלגוריתם מילר־רבין לבדיקת ראשוניות}

יהי
$n$
שלם אי־זוגי. נרצה לדעת האם
$n$
ראשוני.\\
בעזרת אלגוריתם מילר־רבין ניתן לבדוק בהסתברות גבוהה האם מספר הינו ראשוני.

הרעיון הראשון הוא להשתמש במשפט פרמה.
נגריל
$1 < a < n-1$.
אם
$a^{n-1} \not\equiv 1 \mod{n}$
אז
$n$
לא ראשוני.
אז
$a$
נקרא "עד" לכך ש־%
$n$
אינו ראשוני.
אחרת,
$a$
איננו עד, אבל ייתכן עדיין כי
$n$
אינו ראשוני.
ניקח
$b \neq a$
ונבדוק האם
$b^{n-1} \equiv 1$.\\
לרעיון זה יש בעיה, כי אם
$n$
מספר
\textenglish{Carmichael}
אז אינו ראשוני אבל
$a^{n-1} \equiv 1 \mod{n}$
לכל
$a$
עבורו
$\gcd\prs{a,n} = 1$.

כדי לתקן זה, נוסיף עוד עדים. אם
$x^2 \equiv 1 \mod{n}$
כאשר
$x \not\equiv \pm 1 \mod{n}$
אז
$n$
אינו ראשוני.
כדי לבדוק זאת, אם
$n$
אי־זוגי ניתן לכתוב
$n-1 = 2^d m$
כאשר
$m$
אי־זוגי. אז נכתוב
$a^{n-1} = \prs{\prs{\prs{a^m}^2}^{\iddots}}^2$.
אם קיבלנו בשלב מסוים
$1$
ובשלב לפניו לא קיבלנו
$\pm 1$,
אז
$a$
הוא עד.

\begin{algorithm}
נתון
$n$
אי־זוגי.
\begin{enumerate}
\item נפרק
$n-1 = 2^d m$
עבור
$m$
אי־זוגי.
\item נבחר
$a$
בין
$2$
ל־%
$n-1$
באופן אקראי.
\item נחשב
$a^m \mod {n}$.
אם
$a^m \equiv \pm 1 \mod{n}$
נסיים ונחזיר כי
$n$
חשוד להיות ראשוני.
\item אם
$a^m \not\equiv \pm 1 \mod{n}$,
נרשום
$a^m \equiv b_0 \mod{n}$
ונסתכל על הסדרה
\[\text{.} b_0, b_1 = b_0^2 , \ldots , b_{d-1} = b_{d-2}^2\]
אם בשלב ה־
$j$
כלשהו
$b_j \equiv -11 \mod{n}$,
נחזיר כי
$n$
ראשוני. אחרת הוא בוודאות אינו ראשוני.
\end{enumerate}
\end{algorithm}

\begin{remark}
נרצה לחשב את
$a^m$
בצורה יעילה.
נכתוב
$2^{\ell} \leq m < 2^{\ell + 1}$
ונחשב
$a^2, \ldots, a^{2^{\ell}}$
מודולו
$n$.
אז נכתוב את
$a^m$
כמכפלה של החזקות מלמעלה.
\end{remark}

\begin{theorem}
אם
$n > 9$
וקיבלנו בתהליך מילר־רבין ש־%
$n$
ראשוני אז יש סיכוי של פחות מ־
$\frac{1}{2}$
ש־%
$n$
אינו ראשוני.
\end{theorem}
\begin{remark}
סיבוכיות האלגוריתם היא
$\Theta\prs{\prs{\log n}^3}$.
\end{remark}
\begin{remark}
אם נחזור על התהליך עשר פעמים, נקבל שהסיכוי ש־%
$n$
אינו ראשוני הוא
$\prs{\frac{1}{4}}^{10} \sim \frac{1}{1000000}$.
\end{remark}

\begin{theorem}
\newlecture{20 בדצמבר}%
{2018}
יהי
$a \in \NN$
שלם שאינו ריבוע.
יש אינסוף ראשוניים
$p$
עבורם
$a$
אינו שארית ריבועית.
\end{theorem}

\begin{lemma}
נכתוב
$a = b^2 a'$.
אם יש אינסוף ראשוניים
$p$
עבורם
$a'$
אינו שארית ריבועית, אז יש אינסוף ראשוניים עבורם
$a$
אינו שארית ריבועית.
\end{lemma}

\begin{proof}
כתרגיל.
\end{proof}

\begin{proof}[משפט]
נכתוב
$a' = 2^{\alpha} \prod_{i \in [n]} q_i$
כאשר
$\alpha \in \set{0,1}$
ו־%
$q_i$
ראשוניים.

\begin{description}
\item[מקרה א':]
$n \geq 1$.
יהיו
$\set{\ell_i}_{i \in [k]}$
ראשוניים אי־זוגיים ושונים מכל ה־%
$q_i$.
נמצא פתרון למשוואות
\begin{align*}
\forall i \in [k] \colon x \equiv 1 \mod{\ell_i} \\
\forall i \in [n-1] \colon x \equiv 1 \mod{q_j} \\
x \equiv s \mod{q_n} \\
x \equiv 1 \mod{8}
\end{align*}
ולפי משפט השארייות הסיני, יש פתרון
$b$.
נחשב את
$\prs{\frac{a'}{b}}$.
נכתוב
$b = \prod_{i \in [m]} p_i$.
אז
\[\text{.}\prs{\frac{a'}{b}} = \prs{\frac{2^\alpha}{b}} \prod_{i\in[n]} \prs{\frac{a_i}{b}} = \prod_{i\in[m]} \prs{\frac{a'}{p_i}}\]
נחשב את
$\prs{\frac{a'}{b}}$
לפי הביטוי השמאלי.
כיוון ש־%
$b \equiv 1 \mod{8}$,
לפי משפט
$\prs{\frac{2}{b}} = 1$.
לכן לפי משפט
$\prs{\frac{q_1}{b}} = \prs{\frac{b}{q_1}}$.
אבל,
$b$
פתרון של
$x \equiv 1 \mod{q_1}$,
לכן
$\prs{\frac{q_1}{b}} = \prs{\frac{b}{q_1}} = \prs{\frac{1}{q_1}} = 1$.
באותו אופן לכל
$i \in [n-1]$,
ועבור
$n$
נקבל
\[\prs{\frac{q_n}{b}} = \prs{\frac{b}{q_n}} = \prs{\frac{s}{q_n}} = -1\]

אם נבחר
$s$
שאינו שארית ריבועית מודולו
$q_n$.
לכן קיבלנו
\[-1 = \prs{\frac{a'}{b}} = \prod_{i \in [m]} \prs{\frac{a'}{p_i}}\]
ולכן קיים
$p_i$
עבורו
$\prs{\frac{a'}{p_i}} = -1$.
כלומר,
$a'$
אינו שארית ריבועית מודולו
$p_i$.
נניח בשלילה שיש מספר סופי של ראשוניים
$\set{\ell_i}_{i \in [k]}$
שבהם
$a'$
אינו שארית ריבועית, ומקבלים ראשוני חדש
$p_i$
שאינו שארית ריבועית, בסתירה.
לכן יש אינסוף ראשוניים שבהם
$a'$
אינו שארית ריבועית.

\item[מקרה ב':]
יהי
$a' \neq 2$
ונניח בשלילה שיש מספר סופי של ראשוניים
$\ell_1, \ldots, \ell_k$
כך ש־%
$\ell_i \neq 3$
לכל
$i \in [k]$
וגם
$\prs{\frac{2}{\ell_i}} = -1$.
יהי
$b = 8 \prod_{i \in [k]} \ell_i + 3$.
אז
$b$
לא מתחלק ב־%
$3$
וב־%
$\ell_i$.
אז
\[\prs{\frac{2}{b}} = \prs{-1}^{\frac{b^2 - 1}{8}} = 1\]
ולכן
\[\prs{\frac{2}{b}} = \prod_{i \in [m]} \prs{\frac{2}{p_i}} = 1\]
ולכן יש
$i$
כך ש־%
$\prs{\frac{2}{p_i}} = -1$
כאשר
$b = \prod_{i\in[m]} p_i$.
לכן מצאנו ראשוני חדש שאינו שארית ריבועית מוד
$2$.
\end{description}
\end{proof}

\begin{definition}
$\alpha \in \CC$
נקרא מספר אלגברי אם קיים פולינום
$q\prs{x} \in \QQ\brs{x}$
שונה מאפס עבורו
$q\prs{\alpha} = 0$.
\end{definition}
\begin{definition}
$\alpha \in \CC$
נקרא שלם אלגברי אם קיים פולינום מתוקן
$q\prs{x} \in \ZZ\brs{x}$
עבורו
$q \prs{\alpha} = 0$.
\end{definition}
\begin{proposition}
יהי
$\alpha \in \CC$
ויהי
$p\prs{x} \in \QQ\brs{x}$
פולינום אי־פריק.
נניח כי
$p\prs{\alpha} = 0$.
יהי
$m \prs{x} \in \QQ\brs{x}$
פולינום עבורו
$m\prs{\alpha} = 0$.
אז
$\prs{x} \mid m\prs{x}$.
\end{proposition}
\begin{proposition}
אם
$r \in \QQ$
שלם אלגברי אז
$r \in \ZZ$.
\end{proposition}

\begin{proposition}
יהי
$\alpha \in \CC$
ויהי
$p\prs{x} \in \QQ\brs{x}$
פולינום אי־פריק כך ש־%
$p\prs{\alpha} = 0$.
יהי
$m\prs{x} \in \QQ\brs{x}$
פולינום כך ש־%
$m\prs{\alpha} = 0$.
אז
$p\prs{x} \mid m\prs{x}$.
\end{proposition}

\begin{proof}
נניח בשלילה כי
$p\prs{x} \nmid m\prs{x}$.
לכן
$p,m$
זרים
\footnote{
כי
$p$
ראשוני ולכן אי־פריק בחוג
$\QQ\brs{x}$
שהינו אוקלידי}
ולכן קיימים פולנומים
$a,b$
עבורם
$ap + bm = 1$.
נציב
$\alpha$
ונקבל
$0 = a\prs{\alpha} p\prs{\alpha} + b\prs{\alpha} m\prs{\alpha} = 1$
בסתירה.
\end{proof}

\begin{proposition}
יהי
$\alpha \in \CC$
מספר אלגברי.
אז יש פולינום אי־פריק מתוקן
\stress{יחיד}
$p\prs{x} \in \QQ\brs{x}$
עבורו
$p\prs{\alpha} = 0$.
\end{proposition}
\begin{proof}
\begin{description}
\item[קיום:]
קיים פולינום
$q\prs{x} \neq 0$
כך ש־%
$q\prs{\alpha} = 0$,
לפי הגדרת
$\alpha$.
נכתוב
$q\prs{x} = \prod_{i \in [k]} q_i\prs{x}$
כאשר
$q_i$
אי־פריקים.
אבל,
$q\prs{\alpha} = 0$
לכן קיים
$i$
עבורו
$q_i\prs{\alpha} = 0$.

\item[יחידות:]
אם
$p_1,p_2$
אי־פריקים שמתאפסים ב־%
$\alpha$
אז
$p_1\prs{x} \mid p_2\prs{x}$
וגם
$p_2 \prs{x} \mid p_1\prs{x}$
לפי הטענה. אם
$p_1,p_2$
מתוקנים זה גורר
$p_1 = p_2$.
\end{description}
\end{proof}

\begin{definition}
הפולינום היחיד מהמסקנה הנ"ל נקרא הפולינום המינימלי של
$\alpha$.
\end{definition}
\begin{lemma}[גאוס]
יהי
$p\prs{x} \in \ZZ\brs{x}$%
\newlecture{26 בדצמבר}%
{2018}
פולינום מתוקן ונניח כי
$p\prs{x} = q_1\prs{x} q_2\prs{x}$
כאשר
$q_1\prs{x}, q_2\prs{x} \in \QQ\brs{x}$
פולינומים מתוקנים.
אז
$q_1\prs{x}, q_2\prs{x} \in \ZZ\brs{x}$.
\end{lemma}
\begin{proposition}
יהי
$\alpha \in \CC$
מספר אלגברי.
אז
$\alpha$
שלם אלגברי אם ורק אם הפולינום המינימלי
$p_{\alpha}\prs{x}$
שלו ב־%
$\ZZ\brs{x}$.
\end{proposition}

\begin{proof}
אם הפולינום המינימלי עם מקדמים שלמים, ברור כי
$\alpha$
שלם אלגברי.

נניח ש־%
$\alpha$
שלם אלגברי, ונוכיח שהפולינום המינימלי שלו עם מקדמים שלמים.

אם
$\alpha$
שלם אלגברי, קיים
$m\prs{x} \in \ZZ\brs{x}$
מתוקן עבורו
$m\prs{\alpha} = 0$.
לפי הטענה,
$p_{\alpha}\prs{x} \mid m\prs{x}$,
כלומר
$m\prs{x} = p_{\alpha}\prs{x} q\prs{x} \in \ZZ\brs{x}$
ולפי הלמה של גאוס
$p_{\alpha}\prs{x} \in \ZZ\brs{x}$.
\end{proof}

\begin{example}
$\QQ\brs{i}$
שדה בו כל המספרים אלגבריים.
זה נובע מהלמה הבאה.
\end{example}
\begin{lemma}
יהיו
$r_1,r_1 \in \QQ$,
אז
$x = r_1 + r_2 i$
מספר אלגברי.
\end{lemma}
\begin{proof}
מתקיים
\[x^2 = r_1^2 - r_2^2 + 2r_1 r_2 i\]
וגם
\begin{align*}
x^2 -2r_1 x &= r_1^2 - r_2^2 + 2r_1r_2 i - 2r_1^2 - 2r_1r_2 i \\&= -r_1^2 - r_2^2
\end{align*}
וקיבלנו שהפולינום
\[x^2 - 2r_1 x + r_1^2 + r_2^2\]
ב־%
$\QQ\brs{x}$
מאפס את
$r_1 + r_2 i$.
\end{proof}

\begin{example}
נרצה למצוא את השלמים האלגבריים ב־%
$\QQ\brs{i}$.
אם
$r_2 = 0$
אז
$x \in \QQ$
שלם אלגברי.
אחרת,
$r_1 + r_2 i \notin \QQ$
לכן הפולינום המינימלי שלו אינו מדרגה
$1$.
\[p_1\prs{x} = x^2 - 2r_1 x + r_1^2 + r_2^2\]
לפי המשפט,
$r_1 + r_2 i$
שלם אלגברי אם ורק אם
$p_1\prs{x} \in \ZZ\brs{x}$.
לכן הדרישה היא
$-2 r_1 \in \ZZ$
וגם
$r_1^2 + r_2^2 \in \ZZ$.
אז ניתן לכתוב
$r_1 = \frac{m}{2}$
כאשר
$m \in \ZZ$.
נכתוב
$r_2 = \frac{c}{d}$
שבר מצומצמם.
אז
\[r_1^2 + r_2^2 = \frac{m^2}{4} + \frac{c^2}{d^2} = \frac{d^2 m^2 + 4c^2}{4d^2} \in \ZZ\]
ואז
\[\text{.}4d^2 \mid d^2 m^2 + 4c^2\]
כלומר
\[d^2 \mid d^2 m^2 + 4c^2\]
ואז
\[d^2 \mid 4c^2\]
ואז
$d^2 \mid 4$
ונקבל
$d \in \set{\pm 1, \pm 2}$.
לכן נכתוב
$r_2 = \frac{c_1}{2}$
כאשר
$c_1$
יכול להיות זוגי.
נכתוב
\[r_1^2 + r_2^2 = \frac{m^2 + c_1^2}{4} \in \ZZ\]
כלומר
$4 \mid m^2 + c_1^2$.
אם
$m,c_1$
אי–זוגיים, אז
$m^2 + c_1^2 \equiv 2\mod{4}$
בסתירה!
אחרת
$m,c_1$
זוגיים ולכן
$r_1,r_2 \in \ZZ$.
\end{example}

\begin{proposition}
$\QQ\brs{\omega}$
הוא שדה בו כל האיברים הם מספרים אלגבריים.
השלמים האלגבריים בתוך
$\QQ\brs{\omega}$
הם
$\ZZ\brs{\omega}$.
\end{proposition}
\begin{proof}
נכתוב
$\alpha = r_1 + r_2 \omega$.
נחשב.
\begin{align*}
\prs{x-\alpha}\prs{x-\bar{\alpha}} &=
\prs{x-\prs{r_1 + r_2 \omega}} \prs{x-\prs{r_1 + r_2\bar{\omega}}} \\&=
\prs{x - \prs{r_1 + r_2 \omega}} \prs{x-\prs{r_1 + r_2 \omega^2}} \\&=
x^2 + \prs{-2r_1 - r_2 \omega - r_2 \omega^2} x + r_1^2 - r_1 r_2 + r_2^2 \\&=
x^2 + \prs{-2r_1 - r_2\prs{\omega + \omega^2}} x + r_1^2 - r_1 r_2 + r_2^2 \\
&= x^2 + \prs{-2r_1 + r_2} x + r_1^2 - r_1 r_2 + r_2^2 \in \QQ\brs{x}
\end{align*}
לכן
$\alpha$
מספר אלגברי.
אז
$r_1 + r_2\omega$
שלם אלגברי אם ורק אם
$r_1^2 - r_1 r_2 + r_2^2 \in \ZZ$
וגם
$-2r_1 + r_2 \in \ZZ$.
במקרה זה
\[\prs{r_2 - 2 r_1}^2 + 3r_2^2 = 4\prs{r_1^2 + r_1r_2 + r_2^2} \in \ZZ\]
ואז
$3r_2^2 \in \ZZ$
ולכן
$r_2 \in \ZZ$.
נתון
$-2r_1 + r_2 \in \ZZ$
לכן
$-2r_1 \in \ZZ$
ונכתוב
$r_1 = \frac{m}{2}$.
אז
\[r_1 \prs{r_1 - r_2} = \frac{m^2}{4} - \frac{m r_2}{2} \in \ZZ\]
ואפשר לקבל מכאן כי
$r_1 \in \ZZ$.
\end{proof}
\begin{proposition}
יהי
$\alpha$
מספר אלגברי.
אז
$\QQ\brs{\alpha} = \QQ\prs{\alpha}$.
\end{proposition}
\begin{proof}
יהי
$p\prs{x} \in \QQ\brs{x}$
שאינו מתאפס ב־%
$\alpha$,
ונראה כי
$\frac{1}{p\prs{\alpha}} \in \QQ\brs{\alpha}$.\\
$p_{\alpha}\prs{x}$
איננו פריק.
מתקיים
\[\text{.} \gcd\prs{p\prs{x}, p_{\alpha}\prs{x}} = 1\]
אז קיימים פולינומים
$a\prs{x},b\prs{x} \in \QQ\brs{x}$
עבורם
\[a\prs{x} p\prs{x}  b\prs{x} p_{\alpha}\prs{x} = 1\]
ולאחר הצבה נקבל
$a\prs{\alpha} p\prs{\alpha} = 1$
כלומר
$b\prs{\alpha} = \frac{1}{p\prs{\alpha}}$.
\end{proof}

\begin{proposition}
יהי
$\alpha$
אלגברי עם פולינום מינימלי מדרגה
$n$.
אז
\[\brs{\QQ\brs{\alpha} : \QQ} = n\]
ובסיס ההרחבה הוא
$1,\alpha,\ldots, \alpha^{n-1}$.
\end{proposition}

\begin{proof}
אם הוקטורים תלויים לינארית, נקבל פולינום שונה מאפס ממעלה קטנה מ־%
$n$
המאפס את
$\alpha$.
ע"י בידוד
$\alpha^n$
מהמשוואה מקבלים כי
$\alpha^n$
בשדה, ובאופן דומה אפשר להראות שהקבוצה פורשת.
\end{proof}

\begin{theorem}
אוסף המספרים האלגבריים הוא שדה.
\end{theorem}

\begin{proof}
נציג את רעיון ההוכחה.

\begin{description}

\item[הופכי:]
אם
$\alpha$
אלגברי או שלם אלגברי, אז
$\bar{\alpha}$
גם כזה.
\begin{align*}
\alpha^n + b_{n-1}\alpha^{n-1} + \ldots + b_1 \alpha + b_0 =0
\end{align*}
לכן
\begin{align*}
\prs{-1}^n \prs{-\alpha}^n + \prs{-1}^{n-1} b_{n-1}\prs{-\alpha}^{n-1} + \ldots \pm b_1 \prs{-\alpha} + b_0 = 0
\end{align*}
לכן
\[b_n' \prs{-\alpha}^n + b_{n-1}' \prs{-\alpha}^{n-1} + \ldots + b_1'\prs{-\alpha} + b_0 = 0\]
מאפס את
$-\alpha$.
אם
$\alpha \neq 0$
מספר אלגברי אז גם
$\frac{1}{\alpha}$
כזה.
אז
\[1 + \sum_{k\in[n]} \frac{b_{n-k}}{\alpha^{n-k}} = 0\]
לכן
\[1+ \sum_{k \in [n]} b_{n-k} \prs{\frac{1}{\alpha}}^k = 0\]
לכן
$\frac{1}{\alpha}$
מספר אלגברי.
\item[סגירות:]
אם
$\alpha$
מספר אלגברי, ראינו כי השדה
$\QQ\prs{\alpha} = \QQ\brs{\alpha}$
מ"ו ממימד
$n$
מעל
$\QQ$
כאשר
$n = \deg p_{\alpha}$.
\end{description}
\end{proof}

\begin{theorem}
אוסף השלמים האלגבריים הוא חוג. נסמן אותו
$\Omega$.
\end{theorem}

\begin{corollary}
ב־%
$K \ceq \QQ\brs{\alpha}$
כל איבר הוא מספר אלגברי.
חוג השלמים של
$K$
הוא
$O_K \ceq \Omega \cap K$.
\end{corollary}
\begin{example}
הראינו שב־%
$\QQ\brs{i}$
חוג השלמים הוא
$\ZZ\brs{i}$
וב־%
$\QQ\brs{\omega}$
חוג השלמים הוא
$\ZZ\brs{\omega}$.
באופן כללי, כל שדה
$K$
שהוא הרחבה סופית של
$\QQ$
הוא שדה מספרים אלגבריים.
\end{example}

\begin{definition}
$a,b,c \in \Omega$.
נאמר כי
$a \equiv b \mod{c}$
ב־%
$\omega$
אם
$c \mid \prs{b-a}$.
\end{definition}
\begin{proposition}
יהיו
$a,b,c \in \ZZ$.
אם
$a \equiv b \mod{c}$
ב־%
$\Omega$
אז
$a \equiv b \mod{c}$
ב־%
$\ZZ$.
\end{proposition}

\begin{proof}
$c \mid b - a$
לכן קיים
$\alpha \in \Omega$
עבורו
$c\alpha = b - a$
לכן
$\alpha = \frac{b-a}{c} \in \QQ$.
קיבלנו כי
$\alpha$
שלם אלגסרי ורציונלי לכן
$\alpha$
שלם, ולכן
$a \equiv b \mod{c}$
גם ב־
$\ZZ$.
\end{proof}
\begin{proposition}
יהיו
$a,b \in \Omega$
ו־%
$p \in \NN$
ראשוני. אז
$\prs{a+b}^p \equiv a^p + b^p$
ב־%
$\Omega$.
\end{proposition}
\begin{proof}
ראינו כי
$p \mid \binom{p}{k}$
לכל
$1 \leq k \leq p-1$
ומכאן נובעת הטענה.
\end{proof}
\begin{example}
נשאל מתי
$2$
שארית ריבועית מוד
$p$.
מהדדיות
\[\text{.} \prs{\frac{2}{p}} = \prs{-1}^{\frac{p^2 - 1}{8}}\]
$2$
יהי
$\zeta = e^{\frac{2 \pi i}{8}} = \frac{1 + i}{\sqrt{2}}$
וידוע
$\zeta^8 = 1$.
לכן
\[\text{.}\prs{\zeta^4 - 1}\prs{\zeta^4 + 1} = 0\]
קל לראות
$\zeta^4 +נסמן 1 = 0$
ולכן
$\zeta^2 + \zeta^{-2} = 0$.
כעת
\[\text{.} \prs{\zeta + \zeta^{-1}}^2 = \zeta^2 + 2 + \zeta^{-2} = 2\]
נסמן
$\tau = \zeta + \zeta^{-1}$
והראנו
$\tau^2 = 2$.
$\tau$
שלם אלגברי כסכום של שני שלמים אלגבריים. אפשר לראות את זה גם מכיוון שהוא שורש של
$x^2 - 2$.
אנו יודעים ש־%
$2^{\frac{p-1}{2}} \equiv \prs{\frac{p}{2}} \mod{p}$.
נציב את
$\tau$
ואז
\begin{align*}
\prs{\tau^2}^{\frac{p-1}{2}} &\equiv \prs{\frac{2}{p}} \mod{p} \\
\tau^{p-1} &\equiv \prs{\frac{2}{p}} \mod{p} \\
\tau^p &\equiv \tau\prs{\frac{2}{p}} \mod{p}
\end{align*}
ב־%
$\Omega$.
\end{example}

\begin{proposition}
\newlecture{2 בינואר}%
{2019}
יהיו
$a,b,c \in \ZZ$
עם
$c \neq 0$.
אם
$a \equiv b \mod{c}$
ב־%
$\Omega$
אז
$a \equiv b \mod{c}$
ב־%
$\ZZ$.
\end{proposition}

נוכיח כעת הדדיות ריבועית עבור
$2$,
כלומר
\[\text{.}\prs{\frac{2}{p}} = \prs{-1}^{\frac{p^2 - 1}{8}}\]
\begin{proof}
יהי
$\zeta = e^{\frac{2\pi i}{8}}$
שלם אלגברי, אז
$\zeta^8 = 2$
כלומר
$\zeta^8 - 1 = 0$
כלומר
\[\text{.} \prs{\zeta^4 + 1}\prs{\zeta^4 - 1} = 0\]
יהי
$\tau = \zeta + \zeta^{-1}$
ואז
$\tau^2 = \zeta^2 + 2 + \zeta^{-2} = 2$
כי
$\zeta^2 + \zeta^{-2} = 0$.
כתבנו את
$\sqrt{2}$
כסכום שורשי יחידה.
\\
יהי
$p\neq 2$
ראשוני, אז
\[\tau^{p-1} = \prs{\tau^2}^{\frac{p-1}{2}} = 2^{\frac{p-1}{2}} \equiv \prs{\frac{2}{p}} \mod{p}\]
ב־%
$\Omega$.
לכן
\[\text{.} \tau^p \equiv \tau \prs{\frac{2}{p}} \mod{p}\]
\\
מצד שני מתקיים
\[\text{.} \tau^p = \prs{\zeta + \zeta^{-1}}^p \equiv \prs{\zeta^p + \zeta^{-p}} \mod{p}\]
נניח
$p \equiv 1 \mod{8}$
כלומר
$p = 8k + 1$
ואז
\[\zeta^p = \zeta^{8k+1} = \zeta^{8k}\zeta = \zeta\]
לכן גם
$\zeta^{-p} = \zeta^{-1}$
ולכן
\[\text{.} \zeta^p + \zeta^{-p} = \zeta + \zeta^{-1}\]
אם
$p \equiv -1 \mod{8}$
נקבל באותו אופן
$\zeta^p = \zeta^{-1}$
לכן
$\zeta^{-p} = \zeta$
ולכן שוב
\[\text{.} \zeta^p + \zeta^{-p} = \zeta + \zeta^{-1}\]
קיבלנו
\[\text{.} \tau^p \equiv \zeta^p + \zeta^{-p} \equiv \tau \mod{p}\]
ראינו
$\tau^p \equiv \tau \prs{\frac{2}{p}} \mod{p}$
לכן
\[\text{.} \tau \equiv \tau \mod{\frac{2}{p}} \mod{p}\]
נכפול ב־%
$\tau$
ואז
\[\tau^2 \equiv \tau^2 \prs{\frac{2}{p}} \mod{p}\]
כלומר
\[2 \equiv 2\prs{\frac{2}{p}} \mod{p}\]
ב־%
$\Omega$.
לפי הטענה, זה גורר כי
\[2 \equiv 2 \prs{\frac{2}{p}} \mod{p}\]
ב־%
$\ZZ$.
לכן
\[\prs{\frac{2}{p}} \equiv 1 \mod{p}\]
ונקבל
\[\prs{\frac{2}{p}} \equiv 1\]
כנדרש.

אם
$p \equiv 3 \mod{8}$
נקבל
\[\zeta^p = \zeta^3 \equiv -\zeta^{-1}\]
אז
\[\zeta^p = -\zeta\]
ולבסוף
\[\text{.} \zeta^p + \zeta^{-p} = -\zeta -\zeta^{-1} = -\tau\]
אם
$p \equiv \pm 3 \mod{8}$
אז
\begin{align*}
\tau^p &\equiv -\tau \mod{p} \\
\tau \prs{\frac{2}{p}} &\equiv -\tau \mod{p} \\
2 \prs{\frac{2}{p}} &\equiv -2 \mod{p}
\end{align*}
כאשר השקילות האחרונה
ב־%
$\Omega$
ולכן ב־%
$\ZZ$.
כעת
\[\prs{\frac{2}{p}} \equiv -1 \mod{p}\]
ולכן
$\prs{\frac{2}{p}} = -1$.

עבור
$p \equiv - 3 \mod{8}$
הטיעון דומה.
\end{proof}

\chapter{סכומי גאוס}

\section{סכומי גאוס ריבועיים}

יהי
$p$
ראשוני אי־זוגי ונסמן
$\zeta \ceq e^{\frac{2 \pi i}{p}}$.

\begin{lemma}
\[\sum_{t = 0}^{p-1} \zeta^{at} = \fcases{p & a \equiv 0 \mod{p} \\ 0 & a \not\equiv 0 \mod{p}}\]
\end{lemma}
\begin{proof}
אם
$a \equiv 0 \mod{p}$
אז
$\zeta^p = 1$
לכן הסכום הוא
\[ \text{.} 1 + \ldots + 1 \prs{\text{p times}} = p\]
\\
אחרת,
$\gcd \prs{a,p} = 1$
ואז
\[\zeta^a \sum_{t=0}^{p-1} \zeta^{at} = \sum_{t=0}^{p-1} \zeta^{at}\]
אבל
$\zeta^a \neq 0$
ולכן
\[\text{.} \sum_{t=0}^{p-1} \zeta^{at} = 0\]

ניתן לראות זאת בדרך נוספת. הסכום הנדסי ושווה
\begin{align*}
\text{.} \frac{\prs{\zeta^a}^p -1}{\zeta^a - 1} = \frac{0}{\zeta^a - 1} = 0
\end{align*}
\end{proof}

\begin{corollary}
\[\frac{1}{p} \sum_{t=0}^{p-1} \zeta^{t\prs{x-y}} = \delta\prs{x,y}\]
לכל
$x,y \in \ZZ$
וכאשר
$\delta\prs{x,y} = 1$
אם
$x \equiv y \mod {p}$
ואחרת
$\delta\prs{x,y} = 0$.
\end{corollary}
\begin{proof}
נבחר
$a = x-y$.
\end{proof}
\begin{lemma}
\[\sum_{t=0}^{p-1} \prs{\frac{t}{p}} = 0\]
\end{lemma}
\begin{proof}
מתרגיל הבית.
\end{proof}

\begin{definition}
יהי
$a\in \ZZ$.
נגדיר
\stress{סכום גאוס ריבועי}
להיות
\[\text{.} g_a \ceq \sum_{t=0}^{p-1} \prs{\frac{t}{p}} \zeta^{at}\]
\end{definition}

\begin{proposition}
\[g_a = \prs{\frac{a}{p}} g_1\]
\end{proposition}
\begin{proof}
אם
$a \equiv 0 \mod{p}$
אז
$\zeta^{at} = 1$
כי
$\zeta^a = 1$.
אז
\[g_a = \sum_{t=0}^{p-1}\prs{\frac{t}{p}} = 0\]
לפי הלמה.
\\
אם
$a \not\equiv 0 \mod{p}$,
נחשב
\begin{align*}
\prs{\frac{a}{p}} g_a &= \prs{\frac{a}{p}} \sum_{t=0}^{p-1} \prs{\frac{t}{p}} \zeta^{at} \\&=
\sum_{t=0}^{p-1}\prs{\frac{at}{p}} \zeta^{at}
\end{align*}
כאשר
$t$
עובר מ־%
$0$
עד
$p-1$,
המספרים
$at$
נותנים את כל עהערכים השונים מוד
$p$.
מתקיים
$at \equiv k \mod{p}$
וגם
$t \equiv $
\end{proof}

\begin{notation}
$g = g_1$.
\end{notation}

\begin{theorem}
\[g^2 = \prs{-1}^{\frac{p-1}{2}} p\]
\end{theorem}
\begin{proof}
נחשב את
\[\sum_{a=0}^{p-1} g_a g_{-a}\]
בשתי דרכים.

\begin{enumerate}
\item \begin{align*}
\sum_{a=0}^{p-1} g_a g_{-a} &= \sum_{a=0}^{p-1} \prs{\frac{a}{p}} g \prs{\frac{-a}{p}} g \\&= \sum_{a=0}^{p-1} \prs{\frac{-a^2}{p}} g^2 \\&=
\sum_{a=1}^{p-1} \prs{\frac{-1}{p}}g^2 \\&= -\prs{p-2}g^2 \\
&= \prs{-1}^{\frac{p-1}{2}} \prs{p-1} g^2
\end{align*}
\item
\begin{align*}
\sum_{a=0}^{p-1} g_a g_{-a} &= \sum_{a=0}^{p-1} \prs{\sum_{t=0}^{p-1} \prs{\frac{t}{p}} \zeta^{at}} \prs{\sum_{s=0}^{p-1} \prs{\frac{s}{p}} \zeta^{-sa}} \\&=
\sum_{a=0}^{p-1} \sum_{t=0}^{p-1} \sum_{s=0}^{p-1} \prs{\frac{ts}{p}} \zeta^{a\prs{t-s}} \\&=
\sum_{t=0}^{p-1} \sum_{s=0}^{p-1} \sum_{a=0}^{p-1} \prs{\frac{ts}{p}} \zeta^{a\prs{t-s}} \\&=
\sum_{t=0}^{p-1} \sum_{s=0}^{p-1} \prs{\frac{ts}{p}} \sum_{a=0}^{p-1} \zeta^{a\prs{t-s}}
\end{align*}
הסכום הימני שונה מאפס רק אם
$t\equiv s \mod{p}$
מלמה קודמת, וזה נכון אם ורק אם
$t=s$.
לכן
\begin{align*}
\sum_{t=0}^{p-1} \sum_{s=0}^{p-1} \prs{\frac{ts}{p}} \sum_{a=0}^{p-1} \zeta^{a\prs{t-s}} &=
\sum_{t=0}^{p-1} \prs{\frac{t^2}{p}} \sum_{a=0}^{p-1} 1 \\&=
\sum_{t=0}^{p-1} \prs{\frac{t^2}{p}}p \\&= \prs{p-1}{p}
\end{align*}
נשווה את הביטויים ונקבל
\[g^2 = \prs{-1}{^\frac{p-1}{2}} p\]
כנדרש.
\end{enumerate}

\end{proof}

\backmatter
\end{document}

